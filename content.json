{"meta":{"title":"æ¢¨ä¸²æ¡ƒçš„ç”Ÿæ´»æ—¥è®°","subtitle":"","description":"æ„ŸçŸ¥å¹¸ç¦æ˜¯ä¸€ç§èƒ½åŠ›","author":"ChuantaoLi","url":"http://example.com","root":"/"},"pages":[{"title":"ç”Ÿæ´»è®°å½•","date":"2026-01-04T17:16:55.266Z","updated":"2026-01-04T17:16:55.266Z","comments":true,"path":"memos/index.html","permalink":"http://example.com/memos/index.html","excerpt":"","text":"#bber { margin-top: 20px; font-family: 'LXGW WenKai Screen', sans-serif; } .bb-list-item { background: rgba(255, 255, 255, 0.85); border-radius: 20px; padding: 25px; margin-bottom: 24px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08); transition: transform 0.3s ease; } .bb-list-item:hover { transform: translateY(-5px); } .bb-content { font-size: 15px; color: #333; line-height: 1.6; } .bb-datetime { font-size: 12px; color: #999; margin-top: 12px; border-top: 1px dashed #eee; padding-top: 8px; } /* --- å›¾ç‰‡å±•ç¤ºä¼˜åŒ–è®¾è®¡ --- */ .bb-content img { cursor: zoom-in; /* é¼ æ ‡ç§»åŠ¨ä¸Šå»æ˜¾ç¤ºæ”¾å¤§é•œå›¾æ ‡ */ max-width: 400px; /* é™åˆ¶å›¾ç‰‡æœ€å¤§å®½åº¦ï¼Œä¸è‡³äºæ’‘æ»¡å±å¹• */ max-height: 300px; /* é™åˆ¶é«˜åº¦ï¼Œé˜²æ­¢é•¿å›¾è¿‡é•¿ */ object-fit: cover; /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹ç¼©æ”¾ */ border-radius: 12px; margin: 10px 0; display: block; box-shadow: 0 4px 12px rgba(0,0,0,0.1); transition: opacity 0.3s ease; } .bb-content img:hover { opacity: 0.8; } /* é¼ æ ‡æ‚¬åœç•¥å¾®å˜æš—æç¤ºå¯ç‚¹å‡» */ /* é€‚é…æ‰‹æœºç«¯ï¼šå›¾ç‰‡è‡ªåŠ¨å……æ»¡å®½åº¦ */ @media screen and (max-width: 768px) { .bb-content img { max-width: 100%; max-height: 400px; } } æ­£åœ¨åŠ è½½å¤‡å¿˜å½•â€¦ var bbMemos = { memos: 'https://memos-api.lct-memos.workers.dev/', limit: '10', creatorId: '1', domId: '#bber', } async function loadMemos() { const bber = document.querySelector(bbMemos.domId); // é€‚é… Memos v1 API è·¯å¾„ï¼ˆå¦‚æœåŠ è½½ä¸å‡ºï¼Œå°è¯•å»æ‰æœ«å°¾çš„ sï¼‰ const fetchUrl = `${bbMemos.memos}api/v1/memo?creatorId=${bbMemos.creatorId}&limit=${bbMemos.limit}&rowStatus=NORMAL`; try { const res = await fetch(fetchUrl); const memos = await res.json(); let html = \"\"; memos.forEach(memo => { let content = marked.parse(memo.content); let date = new Date(memo.createdTs * 1000).toLocaleString(); html += ` ${content} ${date} `; }); bber.innerHTML = html; // åˆå§‹åŒ–å›¾ç‰‡ç‚¹å‡»æ”¾å¤§åŠŸèƒ½ window.ViewImage && ViewImage.init('.bb-content img'); } catch (err) { bber.innerHTML = \"åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯è®¾ç½®ã€‚\"; } } window.addEventListener('DOMContentLoaded', loadMemos);"},{"title":"æ ‡ç­¾","date":"2024-04-10T15:41:25.000Z","updated":"2026-01-04T08:43:35.421Z","comments":false,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"","date":"2026-01-04T08:20:20.272Z","updated":"2026-01-04T08:20:20.272Z","comments":true,"path":"speak/index.html","permalink":"http://example.com/speak/index.html","excerpt":"","text":"#bber { margin-top: 20px; } .bb-list-item { background: #fff; border-radius: 12px; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #eee; } .bb-content { font-size: 15px; color: #333; line-height: 1.6; } .bb-datetime { font-size: 12px; color: #999; margin-top: 8px; } var bbMemos = { memos : 'https://lct-memos.pages.dev/',//ä¿®æ”¹ä¸ºè‡ªå·±éƒ¨ç½² Memos çš„ç½‘å€ï¼Œæœ«å°¾æœ‰ / æ–œæ  limit : '',//é»˜è®¤æ¯æ¬¡æ˜¾ç¤º 10 æ¡ creatorId:'1' ,//æ—©æœŸé»˜è®¤ä¸º 101 ç”¨æˆ·ï¼Œæ–°å®‰è£…æ˜¯ 1ï¼› https://demo.usememos.com/u/101 domId: '#bber',//é»˜è®¤ä¸º bber twiEnv:'',//å¯å¼€ twikoo è¯„è®ºï¼Œé»˜è®¤ https://metk.edui.fun/ }"},{"title":"åšå®¢ç±»å‹","date":"2024-04-10T15:40:31.000Z","updated":"2026-01-04T08:39:50.086Z","comments":false,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"æˆ‘çš„ç®€ä»‹","date":"2024-04-10T15:41:56.000Z","updated":"2026-01-04T08:45:07.597Z","comments":false,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":""}],"posts":[{"title":"æ¨èç³»ç»Ÿå­¦ä¹ ç¬”è®°2ï¼šååŒè¿‡æ»¤","slug":"æ¨èç³»ç»Ÿå­¦ä¹ ç¬”è®°2ï¼šåŸºäºç‰©å“çš„ååŒè¿‡æ»¤","date":"2026-01-28T13:06:58.000Z","updated":"2026-01-28T15:29:20.087Z","comments":true,"path":"2026/01/28/æ¨èç³»ç»Ÿå­¦ä¹ ç¬”è®°2ï¼šåŸºäºç‰©å“çš„ååŒè¿‡æ»¤/","permalink":"http://example.com/2026/01/28/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02%EF%BC%9A%E5%9F%BA%E4%BA%8E%E7%89%A9%E5%93%81%E7%9A%84%E5%8D%8F%E5%90%8C%E8%BF%87%E6%BB%A4/","excerpt":"ç‹æ ‘æ£®æ¨èç³»ç»ŸååŒè¿‡æ»¤å­¦ä¹ ç¬”è®°ï¼ŒåŒ…æ‹¬ItemCFå’ŒUserCFã€‚","text":"ç‹æ ‘æ£®æ¨èç³»ç»ŸååŒè¿‡æ»¤å­¦ä¹ ç¬”è®°ï¼ŒåŒ…æ‹¬ItemCFå’ŒUserCFã€‚ åœ¨è¿™ç¯‡ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰ï¼š ï¼šè¡¨ç¤ºä¸ç”¨æˆ·ç›¸å…³è”çš„ç‰©å“é›†åˆï¼Œå³ç”¨æˆ·è¯„ä»·è¿‡çš„ç‰©å“ã€‚ ï¼šè¡¨ç¤ºä¸ç‰©å“ç›¸å…³è”çš„ç”¨æˆ·é›†åˆï¼Œå³è¯„ä»·è¿‡ç‰©å“çš„æ‰€æœ‰ç”¨æˆ·ã€‚ å› æ­¤ï¼Œæ˜¯ç”¨æˆ·è¯„ä»·è¿‡çš„ç‰©å“æ•°ï¼Œè€Œæ˜¯ç‰©å“çš„æµè¡Œåº¦ï¼Œå³è¯„ä»·è¿‡çš„ç”¨æˆ·æ•°ã€‚ ItemCFå’ŒUserCFçš„æ€è·¯å…¶å®ç±»ä¼¼ï¼Œåœ¨å‰é¢å…ˆä»‹ç»ItemCFã€‚ 1. æ„å»ºç‰©å“æµè¡Œåº¦ä¸å…±ç°çŸ©é˜µ è¿™ä¸ªé˜¶æ®µçš„ç›®æ ‡æ˜¯ç»Ÿè®¡ç”¨æˆ·è¡Œä¸ºï¼Œä¸ºåç»­è®¡ç®—ç›¸ä¼¼åº¦æä¾›åŸºç¡€æ•°æ®ã€‚ 1.1 æ•°å­¦è¡¨è¾¾ è®¾ä¸ºç”¨æˆ·é›†åˆï¼Œä¸ºç‰©å“é›†åˆã€‚ ç‰©å“æµè¡Œåº¦ (Item Popularity)ï¼šæŒ‡å–œæ¬¢ç‰©å“çš„ç”¨æˆ·æ•°é‡ã€‚ å…¶ä¸­ï¼Œæ˜¯æŒ‡ç¤ºå‡½æ•°ï¼Œæ‹¬å·å†…æ¡ä»¶ä¸ºçœŸåˆ™å–1ï¼Œå¦åˆ™å–0ã€‚ å¯ä»¥çœ‹åˆ°æ±‚å’Œç¬¦å·çš„ä¸‹æ ‡æ˜¯ï¼Œæ‰€ä»¥åœ¨ä»£ç çš„å®ç°ä¸­ï¼Œæ˜¯å¯¹æ¯ä¸ªç”¨æˆ·è¿›è¡Œéå†å®ç°çš„ã€‚åœ¨å¾ªç¯ä¸­ï¼Œå†éå†æ¯ä¸ªç‰©å“ï¼Œåˆ¤æ–­è¯¥ç‰©å“æ˜¯å¦è¢«ç”¨æˆ·äº§ç”Ÿè¿‡è¡Œä¸ºï¼ˆè¯„åˆ†&gt;0ï¼‰ï¼Œæœ‰åˆ™è®¡æ•°ã€‚ ç‰©å“å…±ç°çŸ©é˜µ (Co-occurrence Matrix)ï¼šæŒ‡åŒæ—¶å–œæ¬¢ç‰©å“å’Œç‰©å“çš„ç”¨æˆ·æ•°é‡ã€‚ é¡¾åæ€ä¹‰ï¼Œæœ€ç»ˆæ„å»ºçš„æ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œæ˜¯äºŒç»´çš„ã€‚å› æ­¤åœ¨ä»£ç ä¸­ï¼Œä½¿ç”¨permutationså‡½æ•°å³å¯ç”Ÿæˆç”¨æˆ·è¡Œä¸ºä¸­çš„ä¸¤ä¸¤é…å¯¹ã€‚ ä¾‹å¦‚ç”¨æˆ·Aå–œæ¬¢çš„ç‰©å“æœ‰{a, b, d}ï¼Œé‚£ä¹ˆäº§ç”Ÿçš„é…å¯¹å°±æœ‰ï¼š(a, b), (b, a), (a, d), (d, a), (b, d), (d, b)ã€‚æ ¹æ®äº§ç”Ÿçš„é…å¯¹åœ¨å…±ç°çŸ©é˜µå¯¹åº”çš„ä½ç½®è¿›è¡Œè®¡æ•°ã€‚å’Œç‰©å“æµè¡Œåº¦ä¸€æ ·ï¼Œå…±ç°çŸ©é˜µä¹Ÿæ˜¯é€šè¿‡éå†æ¯ä¸ªç”¨æˆ·å®ç°çš„ï¼Œæ¯å¤„ç†ä¸€ä¸ªç”¨æˆ·ï¼Œå…±ç°çŸ©é˜µå°±ä¼šæ›´æ–°ä¸€æ¬¡ã€‚ ç”±äº§ç”Ÿçš„é…å¯¹å¯ä»¥å‘ç°ï¼Œå…±ç°çŸ©é˜µæ˜¯ä¸€ä¸ªå¯¹ç§°çŸ©é˜µï¼Œè¿™é‡Œä»¤ã€‚ 1.2 ä»£ç å®ç° 12345678910111213141516171819202122232425262728def build_cooccurrence_artifacts(rating_data: Dict[str, Dict[str, float]]) -&gt; Tuple[Dict[str, int], Dict[str, Dict[str, int]]]: \"\"\" ç¬¬ä¸€æ­¥ï¼šæ„å»ºç‰©å“æµè¡Œåº¦å­—å…¸å’Œç‰©å“å…±ç°çŸ©é˜µ é€»è¾‘ï¼šéå†ç”¨æˆ·è¡Œä¸ºï¼Œç»Ÿè®¡ç‰©å“ç‹¬ç«‹å‡ºç°æ¬¡æ•°åŠä¸¤ä¸¤å…±åŒå‡ºç°çš„é¢‘æ¬¡ \"\"\" # ç»Ÿè®¡æ¯ä¸ªç‰©å“è¢«å¤šå°‘ç”¨æˆ·è¯„åˆ†è¿‡ï¼ˆæµè¡Œåº¦ï¼‰ item_popularity = defaultdict(int) # ç»Ÿè®¡ç‰©å“ i å’Œ j åŒæ—¶è¢«å¤šå°‘ç”¨æˆ·è¯„åˆ†è¿‡ï¼ˆå…±ç°æ¬¡æ•°ï¼‰ cooccurrence_counts = defaultdict(lambda: defaultdict(int)) # å¼€å§‹éå†æ¯ä¸€ä¸ªç”¨æˆ·åŠå…¶å¯¹åº”çš„è¯„åˆ†å­—å…¸ for user_id, item_scores in rating_data.items(): # æå–è¯¥ç”¨æˆ·è¯„åˆ†å¤§äº 0 çš„ç‰©å“ ID åˆ—è¡¨ positive_items = [item_id for item_id, score in item_scores.items() if score &gt; 0.0] # éå†è¿™äº›æ­£å‘ç‰©å“ï¼Œæ›´æ–°æ¯ä¸ªç‰©å“çš„å…¨å±€æµè¡Œåº¦ for item_id in positive_items: # ç‰©å“æ¯å‡ºç°ä¸€æ¬¡ï¼Œå…¶æµè¡Œåº¦è®¡æ•°å™¨åŠ  1 item_popularity[item_id] += 1 # åˆ©ç”¨æ’åˆ—ç»„åˆå‡½æ•°ï¼Œç”Ÿæˆç”¨æˆ·è¡Œä¸ºä¸­æ‰€æœ‰ç‰©å“çš„ä¸¤ä¸¤é…å¯¹ï¼ˆå¦‚ a-b, b-aï¼‰ # permutations ä¼šè‡ªåŠ¨å¤„ç† i != j çš„æƒ…å†µ for item_i, item_j in permutations(positive_items, 2): # åœ¨å…±ç°çŸ©é˜µå¯¹åº”çš„æ ¼å­ä¸­è®¡æ•°å€¼åŠ  1 cooccurrence_counts[item_i][item_j] += 1# è®¡ç®—å…±ç°çŸ©é˜µå’Œæµè¡Œåº¦popularity, co_matrix = build_cooccurrence_artifacts(USER_RATING_DATA) 2. è®¡ç®—ç‰©å“ç›¸ä¼¼åº¦çŸ©é˜µ è¿™ä¸ªé˜¶æ®µåˆ©ç”¨å…±ç°æ•°æ®æ¥è¡¡é‡ç‰©å“ä¹‹é—´çš„å…³è”ç¨‹åº¦ã€‚ 2.1 æ•°å­¦è¡¨è¾¾ è¿™é‡Œä½¿ç”¨çš„æ˜¯åŸºäºæ¡ä»¶æ¦‚ç‡çš„ç›¸ä¼¼åº¦å…¬å¼ã€‚ç‰©å“ä¸ç‰©å“çš„ç›¸ä¼¼åº¦å®šä¹‰ä¸ºï¼šåœ¨å–œæ¬¢ç‰©å“çš„ç”¨æˆ·ä¸­ï¼Œæœ‰å¤šå°‘æ¯”ä¾‹çš„äººä¹Ÿå–œæ¬¢ç‰©å“ã€‚ å’Œç‰©å“æµè¡Œåº¦ä¸åŒï¼Œåœ¨ä»£ç ä¸­ç›¸ä¼¼åº¦çŸ©é˜µçš„è®¡ç®—æ˜¯å¯¹æ¯ä¸ªç‰©å“è¿›è¡Œéå†ï¼Œå› æ­¤ç›¸ä¼¼åº¦çŸ©é˜µçš„è®¡ç®—é€»è¾‘æ˜¯ä¸€è¡Œä¸€è¡Œå¾ªç¯ä¸‹å»çš„ï¼Œå³ä¾æ¬¡å¯¹æ¯ä¸ªç‰©å“è®¡ç®—å®ƒå’Œå…¶ä»–ç‰©å“çš„ç›¸ä¼¼åº¦ã€‚ å› ä¸ºç›¸ä¼¼åº¦çŸ©é˜µçš„åˆ†æ¯æ˜¯ï¼Œå³ç‰©å“çš„æµè¡Œåº¦ï¼Œç›´æ¥è·å–æ¨¡å—ä¸€è®¡ç®—å¥½çš„ç»“æœå³å¯ã€‚ å¯¹ç¬¬ä¸ªç‰©å“è¿›è¡Œè®¡ç®—æ—¶ï¼Œè·å–å…±ç°çŸ©é˜µçš„ç¬¬è¡Œå–å€¼ï¼Œç„¶åé™¤ä»¥å³ä¸ºç›¸ä¼¼åº¦çŸ©é˜µçš„ç¬¬è¡Œã€‚ å’Œå…±ç°çŸ©é˜µä¸€æ ·çš„æ˜¯ï¼Œç›¸ä¼¼åº¦çŸ©é˜µçš„å¯¹è§’çº¿è¿™é‡Œä¹Ÿè®¾ç½®ä¸º0ï¼›ä½†ä¸ä¸€æ ·çš„æ˜¯ï¼Œç›¸ä¼¼åº¦çŸ©é˜µå¹¶ä¸æ˜¯å¯¹ç§°çŸ©é˜µï¼Œè¿™æ˜¯å› ä¸ºä¸åŒç‰©å“çš„æµè¡Œåº¦å¾€å¾€ä¸åŒï¼š 2.2 ä»£ç å®ç° 1234567891011121314151617181920212223242526def calculate_similarity_matrix(cooccurrence_matrix: Dict[str, Dict[str, int]], item_popularity: Dict[str, int]) -&gt; Dict[str, Dict[str, float]]: \"\"\" ç¬¬äºŒæ­¥ï¼šåŸºäºå…±ç°çŸ©é˜µè®¡ç®—æœ‰å‘ç›¸ä¼¼åº¦ é€»è¾‘ï¼šW(i,j) = åŒæ—¶å–œæ¬¢ i å’Œ j çš„äººæ•° / å–œæ¬¢ i çš„æ€»äººæ•° \"\"\" # åˆå§‹åŒ–å­˜å‚¨ç›¸ä¼¼åº¦åˆ†æ•°çš„åµŒå¥—å­—å…¸ similarity_matrix = defaultdict(dict) for item_i, related_items in cooccurrence_matrix.items(): # item_i æ˜¯å½“å‰è¡Œå¯¹åº”çš„ç‰©å“ IDï¼Œrelated_items æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œè®°å½•äº†ä¸ item_i å…±åŒå‡ºç°çš„ç‰©å“åŠå…¶å…±ç°æ¬¡æ•° num_users_i = item_popularity[item_i] # è·å–å–œæ¬¢ç‰©å“ i çš„æ€»äººæ•°ä½œä¸ºåˆ†æ¯ # éå†ä¸ç‰©å“ i å…±åŒå‡ºç°çš„æ¯ä¸€ä¸ªç‰©å“ j print(related_items.items()) for item_j, joint_count in related_items.items(): # è®¡ç®—æ¡ä»¶æ¦‚ç‡ï¼šåœ¨ä¹°è¿‡ i çš„äººä¸­ï¼Œæœ‰å¤šå°‘æ¯”ä¾‹ä¹Ÿä¹°äº† j similarity_matrix[item_i][item_j] = joint_count / num_users_i # ä»¥çŸ©é˜µå½¢å¼æ‰“å°ç›¸ä¼¼åº¦è®¡ç®—ç»“æœ display_as_matrix(similarity_matrix, \"ç‰©å“ç›¸ä¼¼åº¦çŸ©é˜µ (Similarity Matrix)\", is_float=True) return {k: dict(v) for k, v in similarity_matrix.items()} # è®¡ç®—ç›¸ä¼¼åº¦çŸ©é˜µitem_sim_matrix = calculate_similarity_matrix(co_matrix, popularity) 3. é¢„æµ‹å…´è¶£å¾—åˆ† è¿™ä¸ªé˜¶æ®µæ ¹æ®ç”¨æˆ·å†å²è¡Œä¸ºé¢„æµ‹å…¶å¯¹æœªçŸ¥ç‰©å“çš„å…´è¶£ã€‚ 3.1 æ•°å­¦è¡¨è¾¾ ç”¨æˆ·å¯¹ç›®æ ‡ç‰©å“çš„é¢„æµ‹å…´è¶£å¾—åˆ†ï¼Œæ˜¯ç”¨æˆ·è¿‡å»è¯„åˆ†è¿‡çš„ç‰©å“ä¸ç›®æ ‡ç‰©å“çš„ç›¸ä¼¼åº¦åŠ æƒå’Œã€‚ å…¶ä¸­ï¼š ï¼šç”¨æˆ·è¯„ä»·è¿‡çš„ç‰©å“é›†åˆã€‚ ï¼šç”¨æˆ·å¯¹ç‰©å“çš„å®é™…è¯„åˆ†ã€‚ ï¼šç‰©å“ä¸ç‰©å“çš„ç›¸ä¼¼åº¦ã€‚ å› ä¸ºæ˜¯å¯¹æŒ‡å®šçš„ç”¨æˆ·è¿›è¡Œå…´è¶£å¾—åˆ†çš„è®¡ç®—ï¼Œæ‰€ä»¥åœ¨ä»£ç ä¸­ç”¨æˆ·æ˜¯ä¸€ä¸ªä¼ å…¥å‡½æ•°çš„å‚æ•°ã€‚ ç”±æ±‚å’Œç¬¦å·çš„ä¸‹æ ‡å¯çŸ¥ï¼Œä»£ç éœ€è¦éå†æ¯ä¸ªç‰©å“ã€‚å¯¹äºæ¯ä¸ªç‰©å“ï¼Œæå–ç”¨æˆ·å¯¹å®ƒçš„è¯„åˆ†ï¼Œä»¥åŠå®ƒå’Œç›®æ ‡ç‰©å“çš„ç›¸ä¼¼åº¦ï¼Œç›¸ä¹˜å³å¯ã€‚ æ¯ä¸ªå¾ªç¯éƒ½ä¼šè®¡ç®—ä¸€ä¸ªä¹˜ç§¯ï¼Œç´¯åŠ åå¾—åˆ°çš„ç»“æœå°±æ˜¯å…´è¶£å¾—åˆ†ã€‚ 3.2 ä»£ç å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354def predict_item_score(user_id: str, target_item_id: str, rating_data: Dict[str, Dict[str, float]], sim_matrix: Dict[str, Dict[str, float]]) -&gt; float: \"\"\" ç¬¬ä¸‰æ­¥ï¼šé¢„æµ‹ç‰¹å®šç”¨æˆ·å¯¹ç‰¹å®šç‰©å“çš„å…´è¶£å¾—åˆ† é€»è¾‘ï¼šç”¨æˆ·çš„å…´è¶£å¾—åˆ† = sum( ç›®æ ‡ç‰©å“ä¸å†å²ç‰©å“çš„ç›¸ä¼¼åº¦ * ç”¨æˆ·å¯¹å†å²ç‰©å“çš„è¯„åˆ† ) \"\"\" predicted_score = 0.0 # neighbors æ˜¯æ‰€æœ‰ä¸ç›®æ ‡ç‰©å“ j æœ‰ç›¸ä¼¼åº¦çš„ç‰©å“ iï¼Œä»¥åŠå®ƒçš„ç›¸ä¼¼åº¦ neighbors = sim_matrix.get(target_item_id, {}) # user_history_ratings æ˜¯ç”¨æˆ· u å¯¹æ‰€æœ‰å†å²ç‰©å“ i çš„è¯„åˆ† user_history_ratings = rating_data.get(user_id, {}) # éå†æ‰€æœ‰ä¸ç›®æ ‡ç‰©å“ç›¸å…³çš„é‚»å±…ç‰©å“ for neighbor_item_id, sim_weight in neighbors.items(): if neighbor_item_id != target_item_id: # ç›®æ ‡ç‰©å“ä¸å‚ä¸è®¡ç®— # è·å–ç”¨æˆ·å¯¹è¯¥é‚»å±…ç‰©å“çš„çœŸå®è¯„åˆ†ï¼Œè‹¥æ— è¯„åˆ†åˆ™é»˜è®¤ä¸º 0 actual_rating = user_history_ratings.get(neighbor_item_id, 0.0) # åŠ æƒç´¯åŠ ï¼šç›¸ä¼¼åº¦æƒé‡ * çœŸå®è¯„åˆ† predicted_score += sim_weight * actual_rating return predicted_scoredef get_recommendations(user_id: str, rating_data: Dict[str, Dict[str, float]], sim_matrix: Dict[str, Dict[str, float]]) -&gt; Dict[str, float]: \"\"\" ç¬¬å››æ­¥ï¼šä¸ºç”¨æˆ·ç”Ÿæˆå®Œæ•´çš„è¯„åˆ†é¢„æµ‹æ¸…å• é€»è¾‘ï¼šéå†ç”¨æˆ·æ¸…å•ä¸­çš„ç‰©å“ï¼Œé€ä¸€è®¡ç®—é¢„æµ‹åˆ† \"\"\" # è·å–ç‰©å“åˆ—è¡¨ user_rated_items = rating_data.get(user_id, {}).keys() # å­˜å‚¨æœ€ç»ˆçš„é¢„æµ‹ç»“æœ recommendation_results = {} # å¯¹æ¯ä¸€ä¸ªç‰©å“è®¡ç®—ä¸€ä¸ªåŸºäºååŒè¿‡æ»¤çš„é¢„æµ‹åˆ† for item_id in user_rated_items: # è°ƒç”¨å•ä¸ªè¯„åˆ†é¢„æµ‹å‡½æ•° score = predict_item_score(user_id, item_id, rating_data, sim_matrix) # å°†ç»“æœå­˜å…¥å­—å…¸ï¼Œä¿ç•™ä¸‰ä½å°æ•°ä»¥ä¾¿è§‚å¯Ÿ recommendation_results[item_id] = round(score, 3) return recommendation_results user_a_id = 'A' user_a_predictions = get_recommendations(user_a_id, USER_RATING_DATA, item_sim_matrix) # 4. è¾“å‡ºæœ€ç»ˆç»“æœ print(f\"ç”¨æˆ· {user_a_id} çš„ç‰©å“è¯„åˆ†é¢„æµ‹ç»“æœä¸º:\") for item, rank_score in user_a_predictions.items(): print(f\" - ç‰©å“ {item}: é¢„æµ‹å…´è¶£å¾—åˆ†ä¸º {rank_score}\") 4. æƒ©ç½šçƒ­é—¨ç‰©å“ 4.1 æ•°å­¦è¡¨è¾¾ åˆçº§å…¬å¼çš„å±€é™æ€§åœ¨äºï¼šå¦‚æœç‰©å“éå¸¸çƒ­é—¨ï¼Œå¾ˆå¤§ï¼Œé‚£ä¹ˆä¹Ÿä¼šå¾ˆå¤§ï¼Œå¯¼è‡´åé«˜ã€‚ä¸ºäº†å¹³è¡¡è¿™ä¸€ç‚¹ï¼Œå…¬å¼ä¸­å¼•å…¥äº†å¯¹ç‰©å“æµè¡Œåº¦çš„æƒ©ç½šï¼š å…¶ä¸­ï¼š ï¼šæƒ©ç½šå› å­ï¼Œå–å€¼èŒƒå›´ã€‚ ï¼šå¯¹èµ·å§‹ç‰©å“çš„å½’ä¸€åŒ–ã€‚ ï¼šå¯¹ç›®æ ‡ç‰©å“çš„æƒ©ç½šé¡¹ã€‚ç‰©å“è¶Šçƒ­é—¨ï¼Œåˆ†æ¯è¶Šå¤§ï¼Œç›¸ä¼¼åº¦è¢«å‹å¾—è¶Šä½ã€‚ å‡è®¾æœ‰ä¸‰ä¸ªç›®æ ‡ç‰©å“ç­‰å¾…è¢«æ¨èï¼š Xâ‚ï¼ˆå°ä¼—é…ä»¶ï¼‰ï¼š100äººå–œæ¬¢ Xâ‚‚ï¼ˆçƒ­é—¨æ‰‹æœºå£³ï¼‰ï¼š1000äººå–œæ¬¢ Xâ‚ƒï¼ˆä¸­ç­‰å……ç”µå®ï¼‰ï¼š500äººå–œæ¬¢ ç”¨æˆ·å†å²ï¼šä¹°äº†æ‰‹æœºï¼ˆç‰©å“Aï¼Œ10äººå–œæ¬¢ï¼‰ Aâ†’Xâ‚: 5äººåŒæ—¶å–œæ¬¢ (å°ä¼—é…ä»¶) Aâ†’Xâ‚‚: 50äººåŒæ—¶å–œæ¬¢ (çƒ­é—¨æ‰‹æœºå£³) Aâ†’Xâ‚ƒ: 25äººåŒæ—¶å–œæ¬¢ (ä¸­ç­‰å……ç”µå®) æ²¡æœ‰æƒ©ç½šçš„ç›¸ä¼¼åº¦ä¸ºï¼š w(Aâ†’Xâ‚) = 5/10 = 0.5 w(Aâ†’Xâ‚‚) = 50/10 = 5.0 â† è¿™ä¸ªæœ€é«˜ w(Aâ†’Xâ‚ƒ) = 25/10 = 2.5 æœ‰æƒ©ç½šçš„ç›¸ä¼¼åº¦ä¸ºï¼š w(Aâ†’Xâ‚) = 5/âˆš(10Ã—100) â‰ˆ 5/31.6 = 0.158 w(Aâ†’Xâ‚‚) = 50/âˆš(10Ã—1000) â‰ˆ 50/100 = 0.5 w(Aâ†’Xâ‚ƒ) = 25/âˆš(10Ã—500) â‰ˆ 25/70.7 = 0.354 å½“æˆ‘ä»¬å°†è®¾ä¸º0.5æ—¶ï¼Œå…¬å¼æ¼”å˜ä¸ºä½™å¼¦ç›¸ä¼¼åº¦ï¼š 4.2 ä»£ç å®ç° 1234567891011121314151617181920212223242526272829303132def calculate_similarity_matrix_improved(cooccurrence_matrix: Dict[str, Dict[str, int]], item_popularity: Dict[str, int], alpha: float = 0.5) -&gt; Dict[str, Dict[str, float]]: \"\"\" ç¬¬äºŒæ­¥ï¼ˆæ”¹è¿›ç‰ˆï¼‰ï¼šåŸºäºå…±ç°çŸ©é˜µè®¡ç®—ç›¸ä¼¼åº¦ï¼Œå¸¦çƒ­é—¨ç‰©å“æƒ©ç½š é€»è¾‘ï¼šW(i,j) = C(i,j) / (N(i)^(1-alpha) * N(j)^alpha) å½“alpha=0.5æ—¶ï¼Œä¸ºä½™å¼¦ç›¸ä¼¼åº¦ï¼šW(i,j) = C(i,j)/sqrt(N(i)*N(j)) é€šè¿‡æƒ©ç½šçƒ­é—¨ç‰©å“ j æ¥å‡è½»æµè¡Œåº¦åå·®ï¼Œæé«˜é•¿å°¾ç‰©å“çš„æ›å…‰æœºä¼š \"\"\" # åˆå§‹åŒ–å­˜å‚¨ç›¸ä¼¼åº¦åˆ†æ•°çš„åµŒå¥—å­—å…¸ similarity_matrix = defaultdict(dict) for item_i, related_items in cooccurrence_matrix.items(): # è·å–ç‰©å“ i çš„æµè¡Œåº¦ num_users_i = item_popularity[item_i] for item_j, joint_count in related_items.items(): # è·å–ç‰©å“ j çš„æµè¡Œåº¦ï¼ˆç”¨äºæƒ©ç½šçƒ­é—¨ç‰©å“ï¼‰ num_users_j = item_popularity.get(item_j, 1) # é˜²æ­¢é™¤é›¶é”™è¯¯ # æ”¹è¿›åçš„å…¬å¼ï¼šé€šè¿‡å¼•å…¥ num_users_j çš„ alpha æ¬¡å¹‚æ¥æƒ©ç½šçƒ­é—¨ç‰©å“ # å½“ alpha=0.5 æ—¶ï¼Œåˆ†æ¯ç­‰äº sqrt(N(i) * N(j))ï¼Œå³ä½™å¼¦ç›¸ä¼¼åº¦ denominator = math.pow(num_users_i, 1 - alpha) * math.pow(num_users_j, alpha) # è®¡ç®—æœ€ç»ˆç›¸ä¼¼åº¦åˆ†æ•° similarity_matrix[item_i][item_j] = joint_count / denominator if denominator &gt; 0 else 0.0 display_as_matrix(similarity_matrix, f\"ç‰©å“ç›¸ä¼¼åº¦çŸ©é˜µ (æ”¹è¿›ç‰ˆ)\", is_float=True) return {k: dict(v) for k, v in similarity_matrix.items()}item_sim_matrix_improved = calculate_similarity_matrix_improved(co_matrix, popularity, alpha=0.5) 5. ä»ItemCFåˆ°UserCF 5.1 ItemCFæµç¨‹æ¼”ç¤º UserCFå¯ä»¥ç›´è§‚åœ°ç†è§£ä¸ºï¼ŒåŸºäºç”¨æˆ·-&gt;ç‰©å“çš„è¯„åˆ†å­—å…¸æ„é€ ä¸€ä¸ªç‰©å“-&gt;ç”¨æˆ·çš„å€’æ’è¡¨ï¼Œç„¶åæ€è·¯å’ŒItemCFä¸€è‡´ã€‚ å¯¹äºItemCFè€Œè¨€ï¼Œå‡è®¾æœ‰ä»¥ä¸‹ç”¨æˆ·è¯„åˆ†æ•°æ®ï¼š 123456 Movie1 Movie2 Movie3 Movie4 Movie5User_A 5 4 3 0 0User_B 4 5 0 2 0User_C 5 0 4 3 2User_D 0 3 5 4 0User_E 0 0 2 0 4 å¯¹åº”çš„ç”¨æˆ·è¯„åˆ†å­—å…¸ä¸ºï¼š 1234567USER_RATING_DATA = { 'A': {'Movie1': 5, 'Movie2': 4, 'Movie3': 3}, 'B': {'Movie1': 4, 'Movie2': 5, 'Movie4': 2}, 'C': {'Movie1': 5, 'Movie3': 4, 'Movie4': 3, 'Movie5': 2}, 'D': {'Movie2': 3, 'Movie3': 5, 'Movie4': 4}, 'E': {'Movie3': 2, 'Movie5': 4},} éå†æ¯ä¸ªç”¨æˆ·ï¼Œå¯¹å…¶è¯„åˆ†è¿‡çš„ç‰©å“è¿›è¡Œè®¡æ•°ï¼š ç‰©å“ User_A User_B User_C User_D User_E æµè¡Œåº¦ Movie1 âœ“ âœ“ âœ“ âœ— âœ— 3 Movie2 âœ“ âœ“ âœ— âœ“ âœ— 3 Movie3 âœ“ âœ— âœ“ âœ“ âœ“ 4 Movie4 âœ— âœ“ âœ“ âœ“ âœ— 3 Movie5 âœ— âœ— âœ“ âœ— âœ“ 2 å…±ç°çŸ©é˜µè¡¨ç¤ºåŒæ—¶è¢«æŸä¸ªç”¨æˆ·è¯„åˆ†è¿‡çš„ç‰©å“å¯¹å‡ºç°çš„æ¬¡æ•°ã€‚åœ¨ä»£ç çš„å®ç°ä¸­ï¼Œéœ€è¦å¯¹æ¯ä¸ªç”¨æˆ·ï¼Œç”Ÿæˆå…¶è¯„åˆ†ç‰©å“çš„ä¸¤ä¸¤é…å¯¹ï¼Œç„¶ååœ¨çŸ©é˜µä¸­è®¡æ•°ã€‚ç»è¿‡æ‰€æœ‰ç”¨æˆ·çš„å¤„ç†åï¼Œå¾—åˆ°æœ€ç»ˆçš„å…±ç°çŸ©é˜µï¼š 123456 Movie1 Movie2 Movie3 Movie4 Movie5Movie1 0 2 2 1 1Movie2 2 0 2 1 0Movie3 2 2 0 2 1Movie4 1 1 2 0 1Movie5 1 0 1 1 0 ä»¥Movie1ä¸ºä¾‹è®¡ç®—ä¸å…¶ä»–ç‰©å“çš„ç›¸ä¼¼åº¦ï¼Œä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š 1234w(Movie1, Movie2) = 2 / âˆš(3 Ã— 3) = 2 / 3 â‰ˆ 0.667w(Movie1, Movie3) = 2 / âˆš(3 Ã— 4) = 2 / âˆš12 â‰ˆ 2 / 3.464 â‰ˆ 0.577w(Movie1, Movie4) = 1 / âˆš(3 Ã— 3) = 1 / 3 â‰ˆ 0.333w(Movie1, Movie5) = 1 / âˆš(3 Ã— 2) = 1 / âˆš6 â‰ˆ 1 / 2.449 â‰ˆ 0.408 æœ€åæ˜¯å¯¹ç»™å®šçš„ç”¨æˆ·ï¼Œé¢„æµ‹ä»–å¯¹å…¶ä»–ç‰©å“çš„å…´è¶£å¾—åˆ†ã€‚ä»¥é¢„æµ‹User_Aå¯¹Movie4çš„è¯„åˆ†ä¸ºä¾‹ï¼š ç”±è¯„åˆ†å­—å…¸å¯çŸ¥ï¼ŒUser_Açš„è¯„åˆ†ç‰©å“ï¼šâ€˜Aâ€™: {â€˜Movie1â€™: 5, â€˜Movie2â€™: 4, â€˜Movie3â€™: 3}ï¼š 123æ¥è‡ª Movie1: r(A,Movie1) Ã— w(Movie1, Movie4) = 5 Ã— 0.333 = 1.665æ¥è‡ª Movie2: r(A,Movie2) Ã— w(Movie2, Movie4) = 4 Ã— 0.333 = 1.332æ¥è‡ª Movie3: r(A,Movie3) Ã— w(Movie3, Movie4) = 3 Ã— 0.577 = 1.731 å¯¹ä¸Šè¿°ç»“æœæ±‚å’Œå³å¾—åˆ°æœ€ç»ˆçš„å…´è¶£å¾—åˆ†é¢„æµ‹ç»“æœã€‚æ€»ä½“æµç¨‹å¦‚ä¸‹ï¼š 12345678910111213141516åŸå§‹è¯„åˆ†æ•°æ® â†“[ç¬¬ä¸€æ­¥] æ„å»ºæµè¡Œåº¦å’Œå…±ç°çŸ©é˜µ item_popularity = {Movie1: 3, Movie2: 3, Movie3: 4, Movie4: 3, Movie5: 2} cooccurrence = 5x5çŸ©é˜µ â†“[ç¬¬äºŒæ­¥] è®¡ç®—ç›¸ä¼¼åº¦çŸ©é˜µï¼ˆÎ±=0.5ï¼‰ similarity_matrix = 5x5çŸ©é˜µ â†“[ç¬¬ä¸‰æ­¥] é¢„æµ‹è¯„åˆ† å¯¹æ¯ä¸ªç”¨æˆ·çš„æ¯ä¸ªæœªè¯„åˆ†ç‰©å“ï¼Œè®¡ç®—: Î£(ç”¨æˆ·è¯„åˆ† Ã— ç‰©å“ç›¸ä¼¼åº¦) â†“[ç¬¬å››æ­¥] ç”Ÿæˆæ¨èåˆ—è¡¨ æŒ‰é¢„æµ‹è¯„åˆ†æ’åºï¼Œè¿”å›Top-Nç‰©å“ â†“æ¨èç»“æœï¼ˆç”¨æˆ·çœ‹åˆ°çš„æœ€ç»ˆåˆ—è¡¨ï¼‰ 5.2 UserCFæµç¨‹æ¼”ç¤º ä¸ItemCFç›¸åï¼ŒUserCFé¦–å…ˆè®¡ç®—ç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œç„¶ååŸºäºç›¸ä¼¼ç”¨æˆ·çš„è¯„åˆ†æ¥ä¸ºç›®æ ‡ç”¨æˆ·åšæ¨èã€‚ ItemCF: ç‰©å“ â†’ ç›¸ä¼¼ç‰©å“ â†’ ç”¨æˆ·çš„å†å²è¯„åˆ† â†’ é¢„æµ‹è¯„åˆ† UserCF: ç”¨æˆ· â†’ ç›¸ä¼¼ç”¨æˆ· â†’ ç›¸ä¼¼ç”¨æˆ·çš„ç‰©å“è¯„åˆ† â†’ é¢„æµ‹è¯„åˆ† UserCFçš„æ ¸å¿ƒå…¬å¼æ˜¯ï¼šç”¨æˆ·å¯¹ç‰©å“çš„é¢„æµ‹è¯„åˆ†æ˜¯ç›¸ä¼¼ç”¨æˆ·å¯¹ç‰©å“çš„åŠ æƒè¯„åˆ†ã€‚ å…¶ä¸­ï¼š ï¼šä¸ç”¨æˆ·ç›¸ä¼¼çš„ç”¨æˆ·é›†åˆã€‚ ï¼šç”¨æˆ·å’Œç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚ ï¼šç”¨æˆ·å¯¹ç‰©å“çš„è¯„åˆ†ã€‚ åˆ†å­æ˜¯ç›¸ä¼¼åº¦åŠ æƒçš„è¯„åˆ†ä¹‹å’Œï¼Œåˆ†æ¯æ˜¯ç›¸ä¼¼åº¦æƒé‡ä¹‹å’Œï¼ˆå½’ä¸€åŒ–ï¼‰ã€‚ ç”¨æˆ·ç›¸ä¼¼åº¦è®¡ç®—ï¼šé‡‡ç”¨ä½™å¼¦ç›¸ä¼¼åº¦ï¼ŒåŸºäºç”¨æˆ·å…±åŒè¯„åˆ†è¿‡çš„ç‰©å“ã€‚ å…¶ä¸­ï¼š åˆ†å­ï¼šç”¨æˆ·å’Œç”¨æˆ·å…±åŒè¯„åˆ†ç‰©å“çš„ç‚¹ç§¯ã€‚ åˆ†æ¯ï¼šä¸¤ä¸ªç”¨æˆ·è¯„åˆ†å‘é‡çš„èŒƒæ•°ä¹˜ç§¯ï¼ˆå½’ä¸€åŒ–ï¼‰ã€‚ ä»ç„¶ä½¿ç”¨5.1ä¸­çš„ç›¸åŒæ•°æ®ï¼š 1234567USER_RATING_DATA = { 'A': {'Movie1': 5, 'Movie2': 4, 'Movie3': 3}, 'B': {'Movie1': 4, 'Movie2': 5, 'Movie4': 2}, 'C': {'Movie1': 5, 'Movie3': 4, 'Movie4': 3, 'Movie5': 2}, 'D': {'Movie2': 3, 'Movie3': 5, 'Movie4': 4}, 'E': {'Movie3': 2, 'Movie5': 4},} ç¬¬ä¸€æ­¥ï¼šæ„å»ºç‰©å“åˆ°ç”¨æˆ·çš„å€’æ’è¡¨ å€’æ’è¡¨ç”¨äºé«˜æ•ˆæŸ¥æ‰¾å“ªäº›ç”¨æˆ·è¯„åˆ†è¿‡åŒä¸€ç‰©å“ï¼Œæ˜¯è®¡ç®—ç”¨æˆ·ç›¸ä¼¼åº¦çš„åŸºç¡€ã€‚ 1234567item_to_users = { 'Movie1': {'A': 5, 'B': 4, 'C': 5}, 'Movie2': {'A': 4, 'B': 5, 'D': 3}, 'Movie3': {'A': 3, 'C': 4, 'D': 5, 'E': 2}, 'Movie4': {'B': 2, 'C': 3, 'D': 4}, 'Movie5': {'C': 2, 'E': 4},} ç¬¬äºŒæ­¥ï¼šè®¡ç®—ç”¨æˆ·ç›¸ä¼¼åº¦çŸ©é˜µ æ‰«æå€’æ’è¡¨ï¼Œå¯¹æ¯ä¸ªç‰©å“çš„è¯„åˆ†ç”¨æˆ·è¿›è¡Œä¸¤ä¸¤é…å¯¹ï¼Œè®¡ç®—ç›¸ä¼¼åº¦ã€‚ä»¥ç”¨æˆ·Aå’Œç”¨æˆ·Bä¸ºä¾‹ï¼š å…±åŒè¯„åˆ†ç‰©å“ï¼šMovie1, Movie2 ç‚¹ç§¯è®¡ç®—ï¼š Açš„èŒƒæ•°ï¼š Bçš„èŒƒæ•°ï¼š ç›¸ä¼¼åº¦ï¼š ç±»ä¼¼åœ°è®¡ç®—æ‰€æœ‰ç”¨æˆ·å¯¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå¾—åˆ°ç”¨æˆ·ç›¸ä¼¼åº¦çŸ©é˜µï¼š 123456 A B C D EA 0 0.843 0.756 0.707 0.316B 0.843 0 0.624 0.518 0.000C 0.756 0.624 0 0.894 0.721D 0.707 0.518 0.894 0 0.258E 0.316 0.000 0.721 0.258 0 ç¬¬ä¸‰æ­¥ï¼šé¢„æµ‹ç”¨æˆ·è¯„åˆ† ä¸ºç”¨æˆ·Aé¢„æµ‹æœªè¯„åˆ†ç‰©å“Movie4çš„å¾—åˆ†ã€‚ æŸ¥æ‰¾è¯„åˆ†è¿‡Movie4çš„ç”¨æˆ·åŠå…¶ç›¸ä¼¼åº¦ï¼š ç”¨æˆ·Bï¼šè¯„åˆ†2ï¼Œç›¸ä¼¼åº¦0.843 ç”¨æˆ·Cï¼šè¯„åˆ†3ï¼Œç›¸ä¼¼åº¦0.756 ç”¨æˆ·Dï¼šè¯„åˆ†4ï¼Œç›¸ä¼¼åº¦0.707 åŠ æƒæ±‚å¹³å‡ï¼š æœ€ç»ˆæµç¨‹å›¾ï¼š 1234567891011121314151617åŸå§‹è¯„åˆ†æ•°æ® â†“[ç¬¬ä¸€æ­¥] æ„å»ºç‰©å“åˆ°ç”¨æˆ·çš„å€’æ’è¡¨ item_to_users = {Movie1: {A: 5, B: 4, C: 5}, ...} â†“[ç¬¬äºŒæ­¥] è®¡ç®—ç”¨æˆ·ç›¸ä¼¼åº¦çŸ©é˜µ user_similarity = 5x5å¯¹ç§°çŸ©é˜µï¼ˆå¯¹è§’çº¿ä¸º0ï¼‰ æ‰«æå€’æ’è¡¨ï¼Œå¯¹å…±åŒè¯„åˆ†çš„ç”¨æˆ·è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦ â†“[ç¬¬ä¸‰æ­¥] é¢„æµ‹è¯„åˆ†ï¼ˆå«å™ªå£°è¿‡æ»¤ï¼‰ å¯¹æ¯ä¸ªæœªè¯„åˆ†ç‰©å“ï¼Œè·å–è¯„åˆ†è¿‡å®ƒçš„ç›¸ä¼¼ç”¨æˆ· åŠ æƒæ±‚å¹³å‡ï¼šP_uj = Î£(w_uv Ã— r_vj) / Î£(w_uv) â†“[ç¬¬å››æ­¥] ç”Ÿæˆæ¨èåˆ—è¡¨ æŒ‰é¢„æµ‹è¯„åˆ†æ’åºï¼Œè¿”å›Top-Nç‰©å“ â†“æ¨èç»“æœï¼ˆç”¨æˆ·çœ‹åˆ°çš„æœ€ç»ˆåˆ—è¡¨ï¼‰ å‚è€ƒèµ„æ–™ [1] å¬å›01ï¼šåŸºäºç‰©å“çš„ååŒè¿‡æ»¤ï¼ˆItemCFï¼‰ [2] ååŒè¿‡æ»¤å¬å› (ItemCF/UserCF) - åŸç† &amp; Pythonå®ç° [3] å¯¹äºç‹æ ‘æ£®è€å¸ˆã€Šå°çº¢ä¹¦æ¨èç³»ç»Ÿå…¬å¼€è¯¾ã€‹çš„å¤ç°","categories":[{"name":"ç®—æ³•å­¦ä¹ ","slug":"ç®—æ³•å­¦ä¹ ","permalink":"http://example.com/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"æ¨èç³»ç»Ÿ","slug":"æ¨èç³»ç»Ÿ","permalink":"http://example.com/tags/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/"}]},{"title":"æ¨èç³»ç»Ÿå­¦ä¹ ç¬”è®°1ï¼šæ¨èç³»ç»ŸåŸºç¡€","slug":"æ¨èç³»ç»Ÿå­¦ä¹ ç¬”è®°1ï¼šæ¨èç³»ç»ŸåŸºç¡€","date":"2026-01-28T04:28:55.000Z","updated":"2026-01-28T04:30:56.050Z","comments":true,"path":"2026/01/28/æ¨èç³»ç»Ÿå­¦ä¹ ç¬”è®°1ï¼šæ¨èç³»ç»ŸåŸºç¡€/","permalink":"http://example.com/2026/01/28/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%EF%BC%9A%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/","excerpt":"ç‹æ ‘æ£®æ¨èç³»ç»Ÿå­¦ä¹ ç¬”è®°ï¼ŒåŒ…æ‹¬æ¨èç³»ç»Ÿçš„è¯„ä¼°æŒ‡æ ‡ã€å®éªŒæµç¨‹ã€é“¾è·¯ã€A/Bæµ‹è¯•ç­‰æ¨¡å—ã€‚","text":"ç‹æ ‘æ£®æ¨èç³»ç»Ÿå­¦ä¹ ç¬”è®°ï¼ŒåŒ…æ‹¬æ¨èç³»ç»Ÿçš„è¯„ä¼°æŒ‡æ ‡ã€å®éªŒæµç¨‹ã€é“¾è·¯ã€A/Bæµ‹è¯•ç­‰æ¨¡å—ã€‚ 1. è¯„ä»·æ¨èç³»ç»Ÿçš„æŒ‡æ ‡ æ¶ˆè´¹æŒ‡æ ‡åŒ…æ‹¬ç‚¹å‡»ç‡ã€æ›å…‰ç‡ã€æ”¶è—ç‡ã€è½¬å‘ç‡ã€é˜…è¯»å®Œæˆç‡ç­‰ï¼Œè¿™äº›éƒ½æ˜¯çŸ­æœŸæŒ‡æ ‡ï¼Œæ›´é‡è¦çš„æ˜¯åŒ—ææ˜ŸæŒ‡æ ‡ï¼ˆNorth Star Metricï¼‰ã€‚ åŒ—ææ˜ŸæŒ‡æ ‡åŒ…æ‹¬æ—¥æ´»ç”¨æˆ·æ•°ï¼ˆDAUï¼‰ã€æœˆæ´»ç”¨æˆ·æ•°ï¼ˆMAUï¼‰ã€äººå‡ä½¿ç”¨æ¨èçš„æ—¶é•¿ã€äººå‡é˜…è¯»ç¬”è®°çš„æ•°é‡ã€å‘å¸ƒæ¸—é€ç‡ã€äººå‡å‘å¸ƒé‡ç­‰ã€‚å…¶ä¸­ï¼Œå‘å¸ƒæ¸—é€ç‡æŒ‡çš„æ˜¯å‘å¸ƒè¿‡å†…å®¹çš„äººæ•°ä¸æ€»æ´»è·ƒäººæ•°çš„æ¯”å€¼ï¼Œç”¨äºè¡¡é‡ç”¨æˆ·ä»â€œå›´è§‚è€…â€è½¬å˜ä¸ºâ€œåˆ›ä½œè€…â€çš„æ¯”ä¾‹ã€‚ 2. å®éªŒæµç¨‹ é¦–å…ˆè¿›è¡Œç¦»çº¿å®éªŒï¼Œæ”¶é›†å†å²æ•°æ®ï¼Œåœ¨å†å²æ•°æ®ä¸Šåšè®­ç»ƒã€æµ‹è¯•ï¼Œå¿«é€Ÿè¿­ä»£æ¨¡å‹å‚æ•°ã€‚é€šè¿‡ AUCã€å‡†ç¡®ç‡ã€å¬å›ç‡ç­‰æ•°å­¦æŒ‡æ ‡ï¼Œç­›é€‰å‡ºè¡¨ç°æœ€å¥½çš„å‡ ä¸ªç®—æ³•ç‰ˆæœ¬ã€‚ç®—æ³•æ²¡æœ‰éƒ¨ç½²åˆ°äº§å“ä¸­ï¼Œæ²¡æœ‰è·Ÿç”¨æˆ·äº¤äº’ã€‚ éšåè¿›è¡Œå°æµé‡A/Bæµ‹è¯•ï¼Œå°†å°æµé‡æ± åˆ†ä¸ºAç»„ï¼ˆåŸç®—æ³•ï¼‰å’ŒBç»„ï¼ˆæ–°ç®—æ³•ï¼‰ï¼Œè§‚å¯Ÿä¸¤è€…åœ¨ç‚¹å‡»ç‡ã€ç•™å­˜ã€è½¬åŒ–ç­‰æŒ‡æ ‡ä¸Šçš„å·®å¼‚ã€‚ æœ€åè¿›è¡Œå…¨æµé‡ä¸Šçº¿ï¼Œåœ¨ç¡®è®¤å°æµé‡å®éªŒæ•ˆæœæ˜¾è‘—ä¸”ç¨³å®šåï¼Œå°†æ–°ç®—æ³•æ¨å¹¿ç»™å…¨ç«™ç”¨æˆ·ã€‚ 3. æ¨èç³»ç»Ÿçš„é“¾è·¯ æ¨èç³»ç»Ÿçš„ç›®æ ‡æ˜¯ä»å‡ äº¿ä¸ªç‰©å“ä¸­é€‰å‡ºå‡ åä¸ªç‰©å“å±•ç¤ºç»™ç”¨æˆ·ï¼Œæ¨èç³»ç»Ÿçš„é“¾è·¯å¯åˆ†ä¸ºå››ä¸ªç¯èŠ‚ï¼š å¬å›ï¼ˆRecallï¼‰ å¿«é€Ÿä»å‡ äº¿ç¯‡ç¬”è®°ä¸­å¿«é€Ÿå¬å›ç”¨æˆ·æ„Ÿå…´è¶£çš„å‡ åƒç¯‡ç¬”è®°ï¼Œå¸¸è§çš„å¬å›é€šé“åŒ…æ‹¬ååŒè¿‡æ»¤ã€åŒå¡”æ¨¡å‹ç­‰ã€‚ ç²—æ’ï¼ˆPre-Rankingï¼‰ ä½¿ç”¨å°è§„æ¨¡ç¥ç»ç½‘ç»œè¿›è¡Œæ‰“åˆ†ï¼Œå°†å¬å›çš„å‡ åƒç¯‡ç¬”è®°ç¼©å°åˆ°å‡ ç™¾ç¯‡ã€‚ ç²¾æ’ï¼ˆRankingï¼‰ ä½¿ç”¨å¤§è§„æ¨¡ç¥ç»ç½‘ç»œï¼Œè¾“å…¥æ›´åŠ ä¸°å¯Œçš„ç‰¹å¾å¯¹å‡ ç™¾ç¯‡ç¬”è®°è¿›è¡Œç»¼åˆæ‰“åˆ†ã€‚ é‡æ’ï¼ˆRe-rankingï¼‰ ä»ç²¾æ’å‡ºçš„å‡ ç™¾ç¯‡ä¸­é€‰å‡ºæœ€ç»ˆå±•ç¤ºçš„å‡ åç¯‡ï¼Œä¸ºäº†é˜²æ­¢ç”¨æˆ·åˆ·åˆ°çš„å…¨æ˜¯åŒç±»å†…å®¹ï¼Œç³»ç»Ÿè¿›è¡Œå¤šæ ·æ€§æ‰“åˆ†ï¼Œæ‰“æ•£ç›¸ä¼¼å†…å®¹ï¼ŒåŒæ—¶åœ¨è¿™é‡Œæ’å…¥å¹¿å‘Šã€è¿è¥æ¨å¹¿å†…å®¹ï¼Œæ ¹æ®è§„åˆ™è°ƒæ•´é¡ºåºã€‚ 4. A/Bæµ‹è¯• 4.1 A/Bæµ‹è¯•çš„åŸºæœ¬æµç¨‹ æ‰€æœ‰å¯¹æ¨¡å‹å’Œç­–ç•¥çš„æ”¹è¿›éƒ½éœ€è¦é€šè¿‡A/Bæµ‹è¯•ï¼Œç”¨å®éªŒæ•°æ®æ¥éªŒè¯æ¨¡å‹å’Œç­–ç•¥æ˜¯å¦æœ‰æ•ˆã€‚ä¾‹å¦‚ï¼Œè§‚å¯Ÿæ–°çš„å¬å›é€šé“å¯¹çº¿ä¸ŠæŒ‡æ ‡çš„å½±å“ã€GNNæ·±åº¦çš„å–å€¼é€‰æ‹©ã€‚ 4.2 éšæœºåˆ†æ¡¶ åˆ©ç”¨å“ˆå¸Œå‡½æ•°å°†ç”¨æˆ·IDæ˜ å°„æˆæ•´æ•°ï¼Œç„¶åå‡åŒ€éšæœºåˆ†æˆä¸ªæ¡¶ï¼Œä¾‹å¦‚10ä¸ªæ¡¶ï¼Œæ¯ä¸ªæ¡¶å 10%ç”¨æˆ·ã€‚è¿™é‡Œçš„åˆ†æ¡¶ä½¿ç”¨å“ˆå¸Œå‡½æ•°ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿›è¡ŒæŠ½æ ·ï¼Œæ˜¯å› ä¸ºå¦‚æœç®€å•åœ°ç»™ç”¨æˆ·æŠ½æ ·ï¼Œç³»ç»Ÿå¿…é¡»ç»´æŠ¤ä¸€å¼ å·¨å¤§çš„è¡¨æ ¼æ¥è®°å½•â€œç”¨æˆ·Aåœ¨1å·æ¡¶ï¼Œç”¨æˆ·Båœ¨2å·æ¡¶â€¦â€¦.â€ï¼Œè¿™åœ¨äº¿çº§ç”¨æˆ·é¢å‰æéš¾ç»´æŠ¤çš„ã€‚å¯¹äºå“ˆå¸Œå‡½æ•°è€Œè¨€ï¼Œåªè¦ç”¨æˆ·IDä¸å˜ï¼Œç®—å‡ºæ¥çš„å“ˆå¸Œå€¼æ°¸è¿œä¸€è‡´ã€‚ 4.3 åŒå±‚äº’æ–¥ä¸ä¸åŒå±‚æ­£äº¤ åŒå±‚äº’æ–¥ï¼šåœ¨åŒä¸€å±‚ä¸­ï¼Œ100%çš„æµé‡è¢«åˆ’åˆ†ä¸ºå¤šä¸ªä¸é‡å çš„æ¡¶ï¼Œå¦‚æœä¸€ä¸ªç”¨æˆ·è¿›å…¥äº†å®éªŒAï¼Œä»–å°±ç»å¯¹ä¸ä¼šè¿›å…¥å®éªŒBã€‚å‡è®¾ç°åœ¨éœ€è¦æµ‹è¯•ä¸¤ä¸ªäº’ç›¸å†²çªçš„ç­–ç•¥ï¼šå®éªŒAæ˜¯æŠŠæŒ‰é’®æ”¹çº¢ï¼Œå®éªŒBæ˜¯æŠŠåŒä¸€ä¸ªæŒ‰é’®æ”¹ç»¿ã€‚ä¸€ä¸ªç”¨æˆ·ä¸èƒ½åŒæ—¶çœ‹åˆ°çº¢ç»¿æŒ‰é’®ï¼Œæ‰€ä»¥å®ƒä»¬å¿…é¡»åœ¨åŒä¸€å±‚ä¸­äº’æ–¥ã€‚ ä¸åŒå±‚æ­£äº¤ï¼šæµé‡åœ¨è¿›å…¥æ¯ä¸€å±‚æ—¶ï¼Œéƒ½ä¼šè¢«é‡æ–°æ´—ç‰Œã€‚ç¬¬ä¸€å±‚æ¡¶0çš„ç”¨æˆ·ï¼Œåœ¨è¿›å…¥ç¬¬äºŒå±‚æ—¶ï¼Œä¼šå‡åŒ€åˆ†å¸ƒåœ¨ç¬¬äºŒå±‚çš„0-99ä¸ªæ¡¶ä¸­ã€‚å‡è®¾ç°åœ¨éœ€è¦æµ‹è¯•ä¸ç›¸å…³çš„ç­–ç•¥æ—¶ï¼šç¬¬ä¸€å±‚æµ‹è¯•æœç´¢ç®—æ³•ï¼Œç¬¬äºŒå±‚æµ‹è¯•åº•æ å›¾æ ‡é¢œè‰²ã€‚é€šè¿‡æ­£äº¤ï¼Œå¯ä»¥è®©æœç´¢å®éªŒå’ŒUIå®éªŒåŒæ—¶è¿›è¡Œä¸”äº’ä¸å¹²æ‰°ã€‚ å¯¹äºåŒç±»çš„ç­–ç•¥è€Œè¨€ï¼Œå¦‚ç²¾æ’æ¨¡å‹çš„ä¸¤ç§ç»“æ„ï¼Œå®ƒä»¬å¤©ç„¶äº’æ–¥ï¼Œå¯¹äºä¸€ä¸ªç”¨æˆ·åªèƒ½ç”¨å…¶ä¸­ä¸€ç§ï¼›å†å¦‚æ·»åŠ ä¸¤æ¡å¬å›é€šé“ï¼Œæ•ˆæœä¼šå¢å¼ºæˆ–ç›¸äº’æŠµæ¶ˆï¼Œäº’æ–¥å¯ä»¥é¿å…åŒç±»ç­–ç•¥ç›¸äº’å¹²æ‰°ã€‚ä¸åŒç±»å‹çš„ç­–ç•¥ï¼Œå¦‚æ·»åŠ å¬å›é€šé“å’Œä¼˜åŒ–ç²—æ’æ¨¡å‹ï¼Œå®ƒä»¬é€šå¸¸ä¸ä¼šç›¸äº’å¹²æ‰°ï¼Œå¯ä»¥ä½œä¸ºæ­£äº¤çš„ä¸¤å±‚ã€‚ ä»¿çœŸä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293import mmh3import pandas as pdimport numpy as npimport uuidimport randomclass TrafficSharding: def __init__(self, num_buckets=1000, layers=3): self.num_buckets = num_buckets # ä¸ºæ¯ä¸€å±‚ç”Ÿæˆç‹¬ç«‹çš„ Saltï¼Œç¡®ä¿æ­£äº¤ self.layer_salts = [] for i in range(layers): # ç”Ÿæˆä¸€ä¸ª 0 åˆ° 10000 ä¹‹é—´çš„éšæœºæ•°ï¼Œå¢åŠ éšæœºæ€§ random_num = random.randint(0, 10000) # æŠŠå±‚æ•°ç¼–å· (i) å’Œ éšæœºæ•° ç»„åˆæˆä¸€ä¸ªç›å€¼ï¼Œè¿™æ ·ä¸åŒå±‚çš„å“ˆå¸Œè¾“å…¥ä¸åŒ # æ¯”å¦‚ç¬¬ä¸€å±‚å¯èƒ½æ˜¯ \"layer_0_842\"ï¼Œç¬¬äºŒå±‚æ˜¯ \"layer_1_5531\" salt_label = f\"layer_{i}_{random_num}\" self.layer_salts.append(salt_label) def get_bucket(self, user_id, layer_index=0): \"\"\"æ ¸å¿ƒå“ˆå¸Œåˆ†æ¡¶å‡½æ•°\"\"\" # é€‰æ‹©å¯¹åº”å±‚çš„ç›å€¼ salt = self.layer_salts[layer_index] # ç”¨æˆ·user_idä¸ç›å€¼ç»„åˆæˆå“ˆå¸Œè¾“å…¥ key = str(user_id) + salt # è®¡ç®—å“ˆå¸Œå€¼ hash_val = mmh3.hash(key, signed=False) # å–æ¨¡å¾—åˆ°æ¡¶ç¼–å· return hash_val % self.num_bucketsdef run_simulation(num_users=100000): print(f\"ğŸš€ å¼€å§‹ä»¿çœŸï¼šæ¨¡æ‹Ÿ {num_users} åç”¨æˆ·è¿›å…¥æ­£äº¤åˆ†å±‚ç³»ç»Ÿ...\") sharder = TrafficSharding(num_buckets=100, layers=2) # 100ä¸ªæ¡¶ï¼Œ2å±‚å®éªŒ user_ids = [] # å­˜æ”¾æ‰€æœ‰ç”¨æˆ·çš„ID for i in range(num_users): random_identity = uuid.uuid4() # éšæœºæ•°ç”Ÿæˆå™¨ user_id_string = str(random_identity) # è½¬æ¢ä¸ºå­—ç¬¦ä¸² user_ids.append(user_id_string) results = [] for u in user_ids: # æ¨¡æ‹Ÿç”¨æˆ·åœ¨ä¸¤ä¸ªç‹¬ç«‹å®éªŒå±‚ä¸­çš„åˆ†æ¡¶ bucket_l1 = sharder.get_bucket(u, layer_index=0) bucket_l2 = sharder.get_bucket(u, layer_index=1) results.append({\"user_id\": u, \"layer_1_bucket\": bucket_l1, \"layer_2_bucket\": bucket_l2}) df = pd.DataFrame(results) print(\"\\nâœ… åˆ†å±‚åˆ†æ¡¶ç»“æœé¢„è§ˆï¼š\") print(df.head(5)) # --- 1. å‡åŒ€æ€§æ ¡éªŒ --- print(\"\\nğŸ“Š 1. å‡åŒ€æ€§æ ¡éªŒ (Layer 1):\") column_data = df[\"layer_1_bucket\"] # å–å‡º Layer 1 çš„åˆ†æ¡¶ç»“æœ raw_counts = column_data.value_counts() # è®¡ç®—æ¯ä¸ªæ¡¶çš„ç”¨æˆ·æ•° total_users = len(df) # æ€»ç”¨æˆ·æ•° proportions = raw_counts / total_users # è®¡ç®—æ¯ä¸ªæ¡¶çš„å æ¯” counts = proportions.head(5) print(f\"å‰5ä¸ªæ¡¶çš„æµé‡å æ¯”:\\n{counts}\") # --- 2. æ­£äº¤æ€§æ ¡éªŒ --- # åŸç†ï¼šå¦‚æœåœ¨ Layer 1 å¤„äºæ¡¶ 0 çš„ç”¨æˆ·ï¼Œåœ¨ Layer 2 å‡åŒ€åˆ†å¸ƒåœ¨ 0-99 æ¡¶ä¸­ï¼Œåˆ™è¯´æ˜æ­£äº¤ print(\"\\nğŸ“ 2. æ­£äº¤æ€§æ ¡éªŒ:\") is_in_bucket_0 = df[\"layer_1_bucket\"] == 0 # ç­›é€‰å‡º Layer 1 åœ¨æ¡¶ 0 çš„ç”¨æˆ· subset_l1_bucket0 = df[is_in_bucket_0] # å–å‡ºè¿™äº›ç”¨æˆ· l2_column_for_these_people = subset_l1_bucket0[\"layer_2_bucket\"] # å–å‡ºä»–ä»¬åœ¨ Layer 2 çš„åˆ†æ¡¶ counts_in_l2 = l2_column_for_these_people.value_counts() # ç»Ÿè®¡è¿™äº›ç”¨æˆ·åœ¨ Layer 2 å„æ¡¶çš„æ•°é‡ total_people_in_subset = len(subset_l1_bucket0) proportions_in_l2 = counts_in_l2 / total_people_in_subset # è®¡ç®—å æ¯” l2_dist_in_l1_zero = proportions_in_l2.head(5) print(f\"å½“ Layer 1 å›ºå®šåœ¨æ¡¶ 0 æ—¶ï¼Œè¿™äº›ç”¨æˆ·åœ¨ Layer 2 çš„åˆ†å¸ƒ:\\n{l2_dist_in_l1_zero}\") # --- 3. æ¨¡æ‹Ÿå®éªŒæ•ˆåº”è®¡ç®— (å«ç®€å•çš„ CUPED æ€æƒ³) --- # å‡è®¾ Layer 1 æ­£åœ¨åšä¸€ä¸ªç­–ç•¥ï¼šå‰ 50 ä¸ªæ¡¶æ˜¯å¯¹ç…§ç»„ï¼Œå 50 ä¸ªæ˜¯å®éªŒç»„ df[\"group\"] = np.where(df[\"layer_1_bucket\"] &lt; 50, \"control\", \"treatment\") # æ¨¡æ‹Ÿç”¨æˆ·æŒ‡æ ‡ (Baseline + å®éªŒæå‡ + éšæœºå™ªéŸ³) df[\"metric_pre\"] = np.random.normal(100, 20, num_users) # å®éªŒå‰æ•°æ® lift = 2.0 # å‡è®¾å®éªŒç»„çœŸæœ‰ 2.0 çš„æå‡ df[\"metric_post\"] = df[\"metric_pre\"] + np.where(df[\"group\"] == \"treatment\", lift, 0) + np.random.normal(0, 5, num_users) print(\"\\nğŸ“ˆ 3. å®éªŒç»“æœåˆæ­¥è§‚æµ‹:\") summary = df.groupby(\"group\")[\"metric_post\"].mean() print(summary) print(f\"è§‚æµ‹åˆ°çš„æå‡: {summary['treatment'] - summary['control']:.4f}\")if __name__ == \"__main__\": run_simulation() è¾“å‡ºç»“æœï¼š 123456789101112131415161718192021222324252627282930313233343536ğŸš€ å¼€å§‹ä»¿çœŸï¼šæ¨¡æ‹Ÿ 100000 åç”¨æˆ·è¿›å…¥æ­£äº¤åˆ†å±‚ç³»ç»Ÿ...âœ… åˆ†å±‚åˆ†æ¡¶ç»“æœé¢„è§ˆï¼š user_id layer_1_bucket layer_2_bucket0 9ff5d564-3c2d-4c81-8b7a-0ecc1c9825a4 20 241 35bd6cf2-2eda-4b8c-8848-ac7abce1cfd1 80 292 b1086495-3ed3-4816-a1bb-885064aed80c 36 323 27bffaf2-4403-4b81-86fb-ea49568674ca 31 354 4776cecd-b414-4fe9-b975-c7ba0d459c9e 26 70ğŸ“Š 1. å‡åŒ€æ€§æ ¡éªŒ (Layer 1):å‰5ä¸ªæ¡¶çš„æµé‡å æ¯”:layer_1_bucket4 0.0107418 0.0106332 0.0106282 0.0105565 0.01052Name: count, dtype: float64ğŸ“ 2. æ­£äº¤æ€§æ ¡éªŒ:å½“ Layer 1 å›ºå®šåœ¨æ¡¶ 0 æ—¶ï¼Œè¿™äº›ç”¨æˆ·åœ¨ Layer 2 çš„åˆ†å¸ƒ:layer_2_bucket78 0.02284521 0.02076895 0.01973057 0.01661550 0.015576Name: count, dtype: float64ğŸ“ˆ 3. å®éªŒç»“æœåˆæ­¥è§‚æµ‹:groupcontrol 100.114321treatment 101.810012Name: metric_post, dtype: float64è§‚æµ‹åˆ°çš„æå‡: 1.6957 4.4 Holdoutæœºåˆ¶ åœ¨æ¨èç³»ç»Ÿçš„å…¨é“¾è·¯ä¸­ï¼Œæ¯ä¸ªå°å®éªŒéƒ½ä¼šè¯´æœ‰æå‡ã€‚ä½†ç”±äºå®éªŒä¹‹é—´å­˜åœ¨æ­£äº¤é‡å ï¼Œè¿™äº›æå‡ä¸èƒ½ç®€å•ç›¸åŠ ã€‚ä¸ºäº†çœ‹æ¸…æ•´ä¸ªéƒ¨é—¨çš„æˆæœï¼Œå°†å…¨ç«™æµé‡åˆ’åˆ†ä¸ºä¸¤ä¸ªç»å¯¹äº’æ–¥çš„éƒ¨åˆ†ï¼š 10%çš„Holdoutæ¡¶ï¼šè¿™éƒ¨åˆ†ç”¨æˆ·è¢«â€œå†·å†»â€åœ¨ä¸Šä¸€å‘¨æœŸæœ€ç¨³å¥çš„ç‰ˆæœ¬ï¼Œä¸å‚ä¸æœ¬å‘¨æœŸçš„ä»»ä½•æ–°å®éªŒã€‚ 90%çš„å®éªŒæ¡¶ï¼šè¿™éƒ¨åˆ†ç”¨æˆ·å‚ä¸å¬å›ã€æ’åºç­‰æ‰€æœ‰é“¾è·¯çš„æ–°ç­–ç•¥è¿­ä»£ã€‚ å…¬å¸è€ƒæ ¸çš„æ˜¯æ¨èç³»ç»Ÿå¯¹ä¸šåŠ¡çš„å‡€å¢è´¡çŒ®ã€‚è®¡ç®—å…¬å¼é€šå¸¸å¦‚ä¸‹ï¼š éƒ¨é—¨æ€»ä½“æ”¶ç›Šå®éªŒæ¡¶æŒ‡æ ‡æ¡¶æŒ‡æ ‡æ¡¶æŒ‡æ ‡ ç”±äºå®éªŒæ¡¶å’ŒHoldoutæ¡¶çš„äººæ•°ä¸å¯¹ç­‰ï¼Œä¸èƒ½æ¯”ç»å¯¹å€¼ï¼Œå› æ­¤éœ€è¦å½’ä¸€åŒ–ã€‚åœ¨å‘¨æœŸå¼€å§‹æ—¶ï¼Œä¸¤ç»„æŒ‡æ ‡çš„Diffåº”è¯¥è¶‹äº0ã€‚æ­¤æ—¶çš„ä»»ä½•å·®å¼‚éƒ½æ˜¯éšæœºè¯¯å·®ï¼›éšç€å®éªŒä¸Šçº¿ï¼ŒDiffçš„æ‹‰å¤§æ‰æ˜¯çœŸæ­£çš„æŠ€æœ¯çº¢åˆ©ã€‚ ä¸ºäº†å…¬å¹³è€ƒæ ¸å¹¶é¿å…â€œè€ç”¨æˆ·æ•ˆåº”â€ï¼Œå³é•¿æœŸä¸æ›´æ–°ç­–ç•¥å¯èƒ½å¯¼è‡´ç”¨æˆ·æµå¤±æˆ–è¡Œä¸ºåå·®ï¼Œç³»ç»Ÿä¼šæŒ‰å‘¨æœŸï¼Œå¦‚æ¯å­£åº¦æˆ–åŠå¹´è¿›è¡Œé‡å¯ï¼š æ¨å…¨ä¸é‡Šæ”¾ï¼šå‘¨æœŸç»“æŸï¼Œè¯æ˜æœ‰æ•ˆçš„ç­–ç•¥å…¨éƒ¨å›ºåŒ–ï¼Œåº”ç”¨åˆ°100%çš„ç”¨æˆ·èº«ä¸Šã€‚æ­¤æ—¶ï¼Œæ—§çš„Holdoutæ¡¶æ¶ˆå¤±ã€‚ é‡æ–°æ´—ç‰Œï¼šåˆ©ç”¨å“ˆå¸Œç®—æ³•é‡æ–°æ‰“æ•£ç”¨æˆ·ï¼ŒéšæœºæŠ½å–æ–°çš„10%ä½œä¸ºæ–°ä¸€è½®çš„Holdoutã€‚ åŸºå‡†å¯¹é½ï¼šæ–°å‘¨æœŸç¬¬ä¸€å¤©ï¼Œç”±äº100%çš„ç”¨æˆ·ç”¨çš„éƒ½æ˜¯åŒæ ·çš„ç­–ç•¥ï¼ŒDiffå›å½’åˆ°0é™„è¿‘ã€‚ å¤åˆ©å¢é•¿ï¼šéšç€æ–°ä¸€è½®å¬å›ã€æ’åºå®éªŒçš„æ»šåŠ¨ä¸Šçº¿ï¼Œå®éªŒæ¡¶çš„æŒ‡æ ‡å¼€å§‹å†æ¬¡çˆ¬å¡ï¼Œå½¢æˆæ–°çš„Diffæ›²çº¿ã€‚ 5. å®éªŒæ¨å…¨ä¸åè½¬å®éªŒ åœ¨å°æµé‡A/Bæµ‹è¯•ä¸­è§‚å¯Ÿåˆ°æ˜¾è‘—çš„diffå¢é•¿ï¼Œåˆ™å¯ä»¥æ¨å…¨ã€‚ä¾‹å¦‚ï¼Œå…ˆåœ¨20%çš„ç”¨æˆ·ä¸Šæµ‹è¯•åï¼Œå¦‚æœæœ‰æ•ˆï¼Œå°±æŠŠè¿™ä¸ªå®éªŒå…³é—­ï¼Œå°†æ¡¶ç©ºå‡ºæ¥ï¼Œä¹‹åå†æ–°å¼€ä¸€å±‚ã€‚åœ¨æ¨å…¨åï¼Œå› ä¸ºä½œç”¨çš„ç”¨æˆ·ä»20%æå‡åˆ°äº†90%ï¼Œå› æ­¤diffä¹Ÿä¼šæ‰©å¤§ã€‚ æ¨å…¨åæœ‰çš„æŒ‡æ ‡ä¼šé©¬ä¸Šå‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚ç‚¹å‡»ã€äº¤äº’ç­‰æŒ‡æ ‡ä¼šç«‹åˆ»å—åˆ°æ–°ç­–ç•¥å½±å“ï¼Œä½†ç•™å­˜ç‡ç­‰æŒ‡æ ‡æœ‰æ»åæ€§ï¼Œéœ€è¦é•¿æœŸè§‚æµ‹ã€‚ å®éªŒè§‚æµ‹åˆ°æ˜¾è‘—æ”¶ç›Šåå°½å¿«æ¨å…¨æ–°ç­–ç•¥ã€‚ç›®çš„æ˜¯è…¾å‡ºæ¡¶ä¾›å…¶ä»–å®éªŒä½¿ç”¨ï¼Œæˆ–éœ€è¦åŸºäºæ–°ç­–ç•¥åšåç»­çš„å¼€å‘ã€‚ç”¨åè½¬å®éªŒè§£å†³ä¸Šè¿°çŸ›ç›¾ï¼Œæ—¢å¯ä»¥å°½å¿«æ¨å…¨ï¼Œä¹Ÿå¯ä»¥é•¿æœŸè§‚æµ‹å®éªŒæŒ‡æ ‡ã€‚å…·ä½“åšæ³•æ˜¯åœ¨æ¨å…¨çš„æ–°å±‚ä¸­å¼€ä¸€ä¸ªæ—§ç­–ç•¥çš„æ¡¶ï¼Œé•¿æœŸè§‚æµ‹å®éªŒæŒ‡æ ‡ã€‚ å‚è€ƒèµ„æ–™ [1] æ¨èç³»ç»Ÿå…¬å¼€è¯¾â€”â€”ç‹æ ‘æ£® [2] ç‹æ ‘æ£®æ¨èç³»ç»Ÿå­¦ä¹ ç¬”è®°1ï¼šæ¦‚è¦ [3] æ·±åº¦è§£æA/Bæµ‹è¯•ä¸­çš„å“ˆå¸Œåˆ†æ¡¶ç­–ç•¥ï¼šä»åŸç†åˆ°å®æˆ˜çš„æµé‡åˆ†å±‚æ–¹æ¡ˆ","categories":[{"name":"ç®—æ³•å­¦ä¹ ","slug":"ç®—æ³•å­¦ä¹ ","permalink":"http://example.com/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"æ¨èç³»ç»Ÿ","slug":"æ¨èç³»ç»Ÿ","permalink":"http://example.com/tags/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/"}]},{"title":"PyTorchå­¦ä¹ ç¬”è®°","slug":"PyTorchå­¦ä¹ ç¬”è®°","date":"2026-01-13T13:51:19.000Z","updated":"2026-01-13T13:53:09.371Z","comments":true,"path":"2026/01/13/PyTorchå­¦ä¹ ç¬”è®°/","permalink":"http://example.com/2026/01/13/PyTorch%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"æœ¬æ–‡è®°å½•äº†æˆ‘å¯¹PyTorchçš„å­¦ä¹ è¿‡ç¨‹ï¼Œå‚è€ƒBç«™å°åœŸå †è¯¾ç¨‹ã€‚","text":"æœ¬æ–‡è®°å½•äº†æˆ‘å¯¹PyTorchçš„å­¦ä¹ è¿‡ç¨‹ï¼Œå‚è€ƒBç«™å°åœŸå †è¯¾ç¨‹ã€‚ PyTorchå­¦ä¹ ç¬”è®° æ•°æ®è¯»å– ä½¿ç”¨Datasetè¿›è¡Œæ•°æ®è¯»å– åœ¨PyTorchä¸­ï¼ŒDatasetæ˜¯ä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼Œå…¶è§„å®šäº†æ‰€æœ‰æ•°æ®é›†å¿…é¡»å…·å¤‡ä¸¤ä¸ªåŠŸèƒ½ï¼š __len__ï¼šå‘Šè¯‰æ¨¡å‹è¿™é‡Œä¸€å…±æœ‰å¤šå°‘å¼ å›¾ __getitem__ï¼šå‘Šè¯‰æ¨¡å‹ä¸€ä¸ªç¼–å·idxï¼ŒæŠŠå¯¹åº”çš„å›¾ç‰‡å’Œæ ‡ç­¾ç»™ä½  __getitem__ çš„æŒ‰éœ€è¯»å–å¹¶æ²¡æœ‰åœ¨initä¸­æŠŠæ‰€æœ‰å›¾ç‰‡éƒ½åŠ è½½è¿›å†…å­˜ï¼Œåªæœ‰å½“ä»£ç è¿è¡Œåˆ°dataset[idx]æ—¶ï¼ŒImage.openæ‰ä¼šå»ç£ç›˜è¯»å–è¿™ä¸€å¼ å›¾ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import osfrom PIL import Imagefrom torch.utils.data import Dataset # å¯¼å…¥DatasetåŸºç±»\"\"\"å®šä¹‰ä¸€ä¸ªåä¸ºMyDataçš„ç±»ï¼Œç»§æ‰¿PyTorchæä¾›çš„Datasetç±»\"\"\"class MyDataSet(Dataset): # åˆå§‹åŒ–æ–¹æ³•ï¼šç”¨äºè·å–æ•°æ®çš„ä¿¡æ¯ def __init__(self, root_dirt, label_dirt): \"\"\" :param root_dirt: æ•°æ®é›†çš„æ ¹ç›®å½•è·¯å¾„ :param label_dirt: æ ‡ç­¾çš„æ–‡ä»¶å¤¹åç§° \"\"\" self.root_dirt = root_dirt self.label_dirt = label_dirt # ä½¿ç”¨os.path.joinæ‹¼æ¥è·¯å¾„ self.path = os.path.join(self.root_dirt, self.label_dirt) # è·å–è¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„æ–‡ä»¶åï¼Œä»¥åˆ—è¡¨çš„å½¢å¼å­˜å‚¨ self.img_path = os.listdir(self.path) # è·å–å•ä¸ªæ•°æ®æ ·æœ¬çš„æ–¹æ³• def __getitem__(self, idx): \"\"\" :param idx: æ•°æ®çš„ç¼–å·ï¼Œå¦‚ç¬¬0å¼ å›¾ï¼Œç¬¬1å¼ å›¾ :return: è¿”å›å¤„ç†åçš„å›¾åƒå’Œå¯¹åº”çš„æ ‡ç­¾ \"\"\" # 1. æ ¹æ®ç´¢å¼•idxä»æ–‡ä»¶å¤¹åˆ—è¡¨ä¸­è·å–å¯¹åº”çš„æ–‡ä»¶å img_name = self.img_path[idx] # 2. æ‹¼æ¥å‡ºå®Œæ•´è·¯å¾„ img_item_path = os.path.join(self.root_dirt, self.label_dirt, img_name) # 3. ä½¿ç”¨PILåº“çš„openæ‰“å¼€å›¾ç‰‡æ–‡ä»¶ img = Image.open(img_item_path) # 4. è·å–æ ‡ç­¾ï¼Œä½¿ç”¨æ–‡ä»¶å¤¹åç§°ä½œä¸ºæ ‡ç­¾åç§° label = self.label_dirt # 5. è¿”å›ä¸€ä¸ªå…ƒç»„ï¼šï¼ˆå›¾ç‰‡ï¼Œæ ‡ç­¾ï¼‰ return img, label # è·å–æ•°æ®é›†æ ·æœ¬çš„é•¿åº¦ def __len__(self): return len(self.img_path)\"\"\"ä»£ç æµ‹è¯•\"\"\"# 1. è®¾ç½®æ•°æ®é›†æ‰€åœ¨çš„ç»å¯¹è·¯å¾„root_dirt = r\"D:\\RecommendationSystem\\PyTorchå­¦ä¹ \\hymenoptera_data\\train\"ants_label_dir = \"ants\" # èš‚èšæ–‡ä»¶å¤¹bees_label_dir = \"bees\" # èœœèœ‚æ–‡ä»¶å¤¹# 2. åˆ›å»ºèš‚èšæ•°æ®é›†çš„å®ä¾‹å¯¹è±¡ants_dataset = MyDataSet(root_dirt, ants_label_dir)# 3. è®¿é—®æ•°æ®é›†ï¼Œé€šè¿‡ç´¢å¼•è§¦å‘__getitem__æ–¹æ³•img, label = ants_dataset[0]img.show() ä½¿ç”¨DataLoaderè¿›è¡Œæ‰¹é‡è¯»å– DataLoaderç”¨äºæ‰¹é‡è¯»å–ï¼Œåœ¨ç¥ç»ç½‘ç»œä¸­å¸¸å¸¸è¾“å…¥ä¸€ä¸ªbatchè¿›è¡Œè®­ç»ƒã€‚å¸¸è§çš„å‚æ•°æœ‰Batch Sizeï¼Œè¡¨ç¤ºæ‰¹æ¬¡å¤§å°ï¼›Shuffleï¼Œè¡¨ç¤ºè¾“å…¥å‰å¯¹æ ·æœ¬é¡ºåºè¿›è¡Œæ´—ç‰Œã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455from torch.utils.data import DataLoaderfrom torch.utils.data import Datasetfrom torchvision import transformsfrom PIL import Imageimport osclass MyData(Dataset): def __init__(self, root_dir, label_dir, transforms=None): self.root_dir = root_dir self.label_dir = label_dir self.path = os.path.join(self.root_dir, self.label_dir) self.img_path = os.listdir(self.path) # ç”¨osçš„listdirè·å–æ•°æ®é›†çš„å›¾ç‰‡åˆ—è¡¨ self.transform = transforms # è¾“å…¥å›¾åƒè½¬æ¢æ“ä½œ def __getitem__(self, idx): img_name = self.img_path[idx] # æ ¹æ®idxè·å–å•å¼ å›¾ç‰‡ img_item_path = os.path.join(self.root_dir, self.label_dir, img_name) img = Image.open(img_item_path).convert(\"RGB\") # å¼ºåˆ¶è½¬æ¢æˆä¸‰é€šé“ if self.transform: img = self.transform(img) label = self.label_dir return img, label def __len__(self): return len(self.img_path)# å®šä¹‰ä¸€ä¸ªå˜æ¢ï¼Œå› ä¸ºDataLoaderçš„è¾“å…¥æ˜¯å¼ é‡img_transforms = transforms.Compose( [ transforms.Resize((256, 256)), # è¿›è¡Œç¼©æ”¾ transforms.RandomHorizontalFlip(), # éšæœºæ°´å¹³ç¿»è½¬ï¼Œæ•°æ®å¢å¼º, transforms.ToTensor(), # è½¬æ¢ä¸ºå¼ é‡ transforms.Normalize(mean=[0.5, 0.5, 0.5], std=[0.1, 0.1, 0.1]), # æ ‡å‡†åŒ– ])# åˆ›å»ºèš‚èšæ•°æ®é›†å®ä¾‹root_dir = r\"D:\\RecommendationSystem\\PyTorchå­¦ä¹ \\hymenoptera_data\\train\" # æ ¹ç›®å½•ï¼Œå­˜å‚¨æ•°æ®çº§çš„ç›®å½•ants_label_dir = \"ants\" # èš‚èšç±»åˆ«çš„æ•°æ®é›†ç›®å½•bees_label_dir = \"bees\" # èœœèœ‚ç±»åˆ«çš„æ•°æ®é›†ç›®å½•ants_dataset = MyData(root_dir, ants_label_dir, transforms=img_transforms)MyDataLoader = DataLoader( dataset=ants_dataset, batch_size=32, shuffle=True, drop_last=False)for data in MyDataLoader: imgs, labels = data print(f\"å½“å‰æ‰¹æ¬¡çš„å›¾ç‰‡å½¢çŠ¶ï¼š{imgs.shape}\") ä½¿ç”¨Transformsè¿›è¡Œæ•°æ®è½¬æ¢ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273from PIL import Imagefrom torchvision import transformsimport matplotlib.pyplot as plt# 1. åŠ è½½å›¾ç‰‡img = Image.open(r\"C:\\Users\\13680\\Pictures\\çŒ«å’ªå¤´åƒ.jpg\")# 2. ä»å›¾ç‰‡åˆ°å¼ é‡ (ToTensor)# ç›®çš„ï¼šå°† PIL å›¾ç‰‡è½¬ä¸ºæ¨¡å‹èƒ½å¤„ç†çš„æµ®ç‚¹å¼ é‡ï¼Œå¹¶å°†åƒç´ èŒƒå›´ä» [0, 255] å½’ä¸€åŒ–åˆ° [0, 1]# è¿˜ä¼šè‡ªåŠ¨æŠŠç»´åº¦é¡ºåºä» [H, W, C] è°ƒæ•´ä¸º [C, H, W]to_tensor = transforms.ToTensor()img_tensor = to_tensor(img)print(f\"å¼ é‡å½¢çŠ¶ [é€šé“, é«˜, å®½]: {img_tensor.shape}\")# 3. å°ºå¯¸ç¼©æ”¾ (Resize)# ç›®çš„ï¼šç»Ÿä¸€è¾“å…¥å°ºå¯¸ã€‚æ¨¡å‹ç½‘ç»œå±‚çš„å‚æ•°æ˜¯å›ºå®šçš„ï¼Œå¿…é¡»æ¥å—ç›¸åŒå¤§å°çš„å›¾ç‰‡resize = transforms.Resize((512, 512))img_resized = resize(img)print(f\"ç¼©æ”¾åå½¢çŠ¶: {to_tensor(img_resized).shape}\")# 4. ä¸­å¿ƒè£å‰ª (CenterCrop)# ç›®çš„ï¼šç§»é™¤èƒŒæ™¯å¹²æ‰°ï¼Œåªå…³æ³¨å›¾ç‰‡æœ€ä¸­å¿ƒçš„æ ¸å¿ƒç‰¹å¾ï¼Œæ¯”å¦‚çŒ«è„¸centercrop = transforms.CenterCrop(300)img_croped = centercrop(img)# 5. éšæœºè£å‰ª (RandomCrop)randomcrop = transforms.RandomCrop(size=(100, 200))img_randomcroped = randomcrop(img)# 6. éšæœºæ°´å¹³ç¿»è½¬ (RandomHorizontalFlip)# ç›®çš„ï¼šæ¨¡æ‹Ÿç‰©ä½“ä»ä¸åŒæ–¹å‘å‡ºç°çš„æƒ…å†µã€‚p=0.5 è¡¨ç¤ºä¸€åŠçš„æ¦‚ç‡ç¿»è½¬ï¼Œä¸€åŠä¸ç¿»random_horizontal_flip = transforms.RandomHorizontalFlip(p=0.5)flipped_image = random_horizontal_flip(img)# ç»˜å›¾å±•ç¤ºå¯¹æ¯”plt.figure(figsize=(10, 5))plt.subplot(1, 2, 1)plt.title(\"Original Image\")plt.imshow(img)plt.axis(\"off\") # å…³é—­åæ ‡è½´plt.subplot(1, 2, 2)plt.title(\"Flipped Image\")plt.imshow(flipped_image)plt.axis(\"off\")# plt.show()# 7. å¡«å…… (Pad)# ç›®çš„ï¼šç»™å›¾ç‰‡åŠ è¾¹æ¡†ã€‚åœ¨æŸäº›æ£€æµ‹ä»»åŠ¡ä¸­ï¼Œä¸ºäº†ä¿æŒæ¯”ä¾‹ä¼šå…ˆå¡«å……å†ç¼©æ”¾pad = transforms.Pad(padding=10, fill=0) # ä¸Šä¸‹å·¦å³å„å¡«å…… 10 åƒç´ ï¼Œé»‘è‰²å¡«å……img_padded = pad(img)print(f\"å¡«å……åå½¢çŠ¶: {to_tensor(img_padded).shape}\")# 8. æ ‡å‡†åŒ– (Normalize)# å…¬å¼ï¼šoutput = (input - mean) / std# ç›®çš„ï¼šä½¿æ•°æ®åˆ†å¸ƒåœ¨ 0 é™„è¿‘ã€‚å‡å€¼ 0.5ï¼Œæ ‡å‡†å·® 0.1 æ˜¯ä¸ºäº†è®©å¤§å¤šæ•°åƒç´ è½åœ¨ [-5, 5] ä¹‹é—´mean = [0.5, 0.5, 0.5]std = [0.1, 0.1, 0.1]normalize = transforms.Normalize(mean=mean, std=std)img_normalized = normalize(to_tensor(img))print(f\"æ ‡å‡†åŒ–åçš„åƒç´ å‡å€¼: {img_normalized.mean()}\")# 9. æ“ä½œç»„åˆ (Compose)# ç›®çš„ï¼šå°†ä¸Šè¿°æ‰€æœ‰æ­¥éª¤ä¸²è”æˆä¸€ä¸ªæµæ°´çº¿ï¼Œä»¥ååªéœ€è°ƒç”¨ img_transforms(img)img_transforms = transforms.Compose( [ transforms.Resize((256, 256)), # 1. ç¼©æ”¾ transforms.RandomHorizontalFlip(), # 2. å¢å¼º transforms.ToTensor(), # 3. è½¬å¼ é‡ transforms.Normalize(mean=[0.5, 0.5, 0.5], std=[0.1, 0.1, 0.1]), # 4. æ ‡å‡†åŒ– ])img_transformed = img_transforms(img) ç¥ç»ç½‘ç»œ Moduleçš„ä½¿ç”¨ è¾“å‡ºé€šé“ ï¼ˆOut Channelsï¼‰å…¶å®å°±æ˜¯å·ç§¯æ ¸ï¼ˆFilterï¼‰çš„æ•°é‡ã€‚æ¯ä¸€ä¸ªå·ç§¯æ ¸è´Ÿè´£å¯»æ‰¾ä¸€ç§ç‰¹å¾ã€‚è®¾ç½®64ä¸ªè¾“å‡ºé€šé“ï¼Œå°±ä»£è¡¨æƒ³è®©æ¨¡å‹åœ¨è¿™ä¸€å±‚æå–64ç§ä¸åŒçš„é«˜çº§ç‰¹å¾ã€‚ å½“kernel_size=3ï¼Œpadding=1ï¼Œstride=1æ—¶ï¼Œå·ç§¯åçš„å›¾ç‰‡é•¿å®½ä¸å˜ï¼Œå…¬å¼å¦‚ä¸‹ï¼š è¿™è®©æˆ‘ä»¬åœ¨è®¾è®¡ç½‘ç»œæ—¶ï¼Œåªéœ€è¦æ‹…å¿ƒâ€œæ± åŒ–â€å¸¦æ¥çš„å‡åŠï¼Œè€Œä¸éœ€è¦æ‹…å¿ƒå·ç§¯å±‚è®©å›¾ç‰‡å˜å°ã€‚ å¦‚æœæ²¡æœ‰æ¿€æ´»å‡½æ•°F.reluï¼Œæ— è®ºä½ å †å å¤šå°‘å±‚å·ç§¯ï¼Œç»“æœä¾ç„¶åªæ˜¯ä¸€ä¸ªå¤æ‚çš„çº¿æ€§å…¬å¼ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051import torchimport torch.nn as nnimport torch.nn.functional as Fclass Mymodel(nn.Module): def __init__(self, num_classes): super().__init__() # 1. å·ç§¯å±‚ self.conv1 = nn.Conv2d(3, 16, kernel_size=3, padding=1) self.conv2 = nn.Conv2d(16, 32, kernel_size=3, padding=1) self.conv3 = nn.Conv2d(32, 64, kernel_size=3, padding=1) \"\"\" è¾“å…¥é€šé“æ•°ï¼Œè¾“å‡ºé€šé“æ•°ï¼Œå¡«å……å¤§å° åä¸€å±‚çš„è¾“å…¥é€šé“æ•°è¦ç­‰äºå‰ä¸€å±‚çš„è¾“å‡ºé€šé“æ•° padding = (kernel_size - 1) / 2 \"\"\" # 2. æ± åŒ–å±‚ self.pool = nn.MaxPool2d(kernel_size=2, stride=2) \"\"\" kernel_sizeæ˜¯çª—å£å¤§å°ï¼Œstrideæ˜¯çª—å£æ¯æ¬¡æ»‘åŠ¨çš„è·ç¦»ï¼ŒäºŒè€…ç›¸ç­‰æ—¶ï¼Œæ± åŒ–åçš„å›¾åƒå¤§å°å‡åŠ \"\"\" # 3. å…¨è¿æ¥å±‚ self.fc1 = nn.Linear(64 * 64 * 64, 256) # å‡è®¾è¾“å…¥å›¾åƒçš„å½¢çŠ¶ï¼š(3, 512, 512) self.fc2 = nn.Linear(256, num_classes) def forward(self, x): # å·ç§¯ -&gt; æ¿€æ´» -&gt; æ± åŒ– x = self.pool( F.relu(self.conv1(x)) ) # å·ç§¯åï¼š(16, 512, 512)ï¼›æ± åŒ–åï¼š(16, 256, 256) x = self.pool( F.relu(self.conv2(x)) ) # å·ç§¯åï¼š(32, 256, 256)ï¼›æ± åŒ–åï¼š(32, 128, 128) x = self.pool( F.relu(self.conv3(x)) ) # å·ç§¯åï¼š(64, 128, 128)ï¼›æ± åŒ–åï¼š(64, 64, 64) # å±•å¹³ï¼Œè¿›å…¥å…¨è¿æ¥å±‚å‰ï¼Œéœ€è¦æŠŠå¤šç»´å¼ é‡æ‹‰æˆä¸€ç»´å‘é‡ x = torch.flatten(x, 1) x = F.relu(self.fc1(x)) x = self.fc2(x) return xmodel = Mymodel(num_classes=2)print(model) æ± åŒ–çš„ä½¿ç”¨ æœ€å¤§æ± åŒ–åªçœ‹æœ€å¼ºçš„ä¿¡å·ï¼Œå®ƒèƒ½å¾ˆå¥½åœ°æå–è¾¹ç¼˜ã€çº¹ç†ç­‰å‰§çƒˆå˜åŒ–çš„ç‰¹å¾ã€‚å¹³å‡æ± åŒ– è€ƒè™‘æ‰€æœ‰åƒç´ ï¼Œå¸¸ç”¨äºç½‘ç»œçš„æœ€åä¸€å±‚ï¼Œç”¨æ¥æ•´åˆå…¨å±€ä¿¡æ¯ã€‚ ä¸€ä¸ªéå¸¸æ™®éçš„å·¥ç¨‹ä¹ æƒ¯æ˜¯kernel_size == strideã€‚å¦‚æœkernel_size=2ï¼Œstride=2ï¼Œå›¾ç‰‡å°ºå¯¸ç›´æ¥é™¤ä»¥2ã€‚å¦‚æœstrideå°äºkernel_sizeï¼Œæ± åŒ–çª—å£ä¼šäº§ç”Ÿé‡å ï¼Œè¿™åœ¨å¦‚AlexNetç­‰æŸäº›è€æ¨¡å‹ä¸­è¢«è®¤ä¸ºèƒ½æŠ‘åˆ¶è¿‡æ‹Ÿåˆã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import torchimport torch.nn as nn# æ¨¡æ‹Ÿä¸€ä¸ª 4x4 çš„è¾“å…¥ç‰¹å¾å›¾ (Batch=1, Channel=1, H=4, W=4)input_data = torch.tensor( [[[[10, 20, 5, 0], [30, 40, 0, 5], [1, 2, 100, 80], [0, 1, 90, 70]]]], dtype=torch.float32,)# 1. æœ€å¤§æ± åŒ– (Max Pooling)# ç›®çš„ï¼šä¿ç•™çª—å£å†…æœ€æ˜¾è‘—çš„ç‰¹å¾ï¼ˆæ•°å€¼æœ€å¤§çš„é‚£ä¸ªï¼‰# çª—å£ 2x2ï¼Œæ­¥é•¿ 2ï¼šæ„å‘³ç€å›¾ç‰‡é•¿å®½éƒ½ä¼šå‡åŠmax_pool = nn.MaxPool2d(kernel_size=2, stride=2)# 2. å¹³å‡æ± åŒ– (Average Pooling)# ç›®çš„ï¼šä¿ç•™çª—å£å†…çš„æ•´ä½“èƒŒæ™¯ä¿¡æ¯ï¼ˆè®¡ç®—å¹³å‡å€¼ï¼‰avg_pool = nn.AvgPool2d(kernel_size=2, stride=2)# æ‰§è¡Œæ± åŒ–output_max = max_pool(input_data)output_avg = avg_pool(input_data)print(\"--- åŸå§‹è¾“å…¥ (4x4) ---\")print(input_data[0,0])print(\"\\n--- æœ€å¤§æ± åŒ–ç»“æœ (2x2) ---\")print(output_max[0,0])print(\"\\n--- å¹³å‡æ± åŒ–ç»“æœ (2x2) ---\")print(output_avg[0,0])\"\"\"--- åŸå§‹è¾“å…¥ (4x4) ---tensor([[ 10., 20., 5., 0.], [ 30., 40., 0., 5.], [ 1., 2., 100., 80.], [ 0., 1., 90., 70.]])--- æœ€å¤§æ± åŒ–ç»“æœ (2x2) ---tensor([[ 40., 5.], [ 2., 100.]])--- å¹³å‡æ± åŒ–ç»“æœ (2x2) ---tensor([[25.0000, 2.5000], [ 1.0000, 85.0000]])\"\"\" çº¿æ€§å±‚çš„ä½¿ç”¨ 1234567891011121314151617181920212223242526import torchimport torch.nn as nn# æ¨¡æ‹Ÿä¸€ä¸ªå·ç§¯å±‚è¾“å‡ºçš„ç‰¹å¾å›¾ (Batch=1, Channel=64, H=4, W=4)input_feature_map = torch.randn(1, 64, 4, 4)# --- 1. Flatten (å±•å¹³å±‚) ---# å°†ä¸‰ç»´ç‰¹å¾ (C, H, W) è½¬åŒ–ä¸ºä¸€ç»´ç‰¹å¾å‘é‡ã€‚é»˜è®¤ä» dim=1 å¼€å§‹å±•å¹³ï¼Œä¿ç•™ dim=0 çš„ Batch ç»´åº¦ã€‚flatten = nn.Flatten()output_flatten = flatten(input_feature_map)# --- 2. Linear (çº¿æ€§å±‚/å…¨è¿æ¥å±‚) ---# æ¯ä¸€ä¸ªè¾“å‡ºèŠ‚ç‚¹éƒ½è¿æ¥äº†è¾“å…¥çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œç”¨äºå­¦ä¹ å…¨å±€ç»„åˆé€»è¾‘ã€‚fc = nn.Linear(in_features=1024, out_features=256)output_fc = fc(output_flatten)# --- 3. Dropout (éšæœºå¤±æ´»å±‚) ---# å¼ºåˆ¶è®©ç½‘ç»œåœ¨è®­ç»ƒæ—¶ä¸è¦ä¾èµ–æŸäº›ç‰¹å®šçš„ç¥ç»å…ƒã€‚# p=0.5 è¡¨ç¤ºæ¯æ¬¡è®­ç»ƒæ—¶ï¼ŒéšæœºæŠŠä¸€åŠçš„ç¥ç»å…ƒâ€œå…³æ‰â€ï¼ˆç½®ä¸º0ï¼‰ã€‚dropout = nn.Dropout(p=0.5)output_dropout = dropout(output_fc)print(f\"è¾“å…¥ç‰¹å¾å›¾å½¢çŠ¶: {input_feature_map.shape}\") # [1, 64, 4, 4]print(f\"å±•å¹³åå½¢çŠ¶: {output_flatten.shape}\") # [1, 1024]print(f\"çº¿æ€§å±‚è¾“å‡ºå½¢çŠ¶: {output_fc.shape}\") # [1, 256] éçº¿æ€§æ¿€æ´»çš„ä½¿ç”¨ 123456789101112131415161718192021import torchimport torch.nn as nn# æ¨¡æ‹Ÿä¸€ä¸ªåŒ…å«æ­£æ•°ã€è´Ÿæ•°å’Œé›¶çš„è¾“å…¥å¼ é‡input_data = torch.tensor([-2.0, -1.0, 0.0, 1.0, 2.0])# 1. ReLU æ¿€æ´»å‡½æ•°ï¼šç®€å•é«˜æ•ˆ# é€»è¾‘ï¼šmax(0, x)relu = nn.ReLU()# 2. Sigmoid æ¿€æ´»å‡½æ•°ï¼šå‹ç¼©æ˜ å°„sigmoid = nn.Sigmoid()# æ‰§è¡Œæ¿€æ´»æ“ä½œoutput_relu = relu(input_data)output_sigmoid = sigmoid(input_data)print(f\"è¾“å…¥æ•°æ®: {input_data}\")print(f\"ReLU è¾“å‡º: {output_relu}\")print(f\"Sigmoid è¾“å‡º: {output_sigmoid}\") æ¨¡å‹è®­ç»ƒ åå‘ä¼ æ’­æ‰‹åŠ¨å®ç° 1234567891011121314151617181920212223242526272829303132333435363738394041424344import torch# 1. åˆå§‹åŒ–x = torch.tensor([0.5])y = torch.tensor([1.0])w1 = torch.tensor([0.2])w2 = torch.tensor([0.5])learning_rate = 0.1for epoch in range(3): # --- A. å‰å‘ä¼ æ’­ --- z1 = w1 * x a1 = torch.sigmoid(z1) z2 = w2 * a1 a2 = torch.sigmoid(z2) C = 0.5 * (a2 - y) ** 2 # --- B. åå‘ä¼ æ’­ --- # --- ç¬¬ä¸€æ­¥ï¼šè®¡ç®— w2 çš„æ¢¯åº¦ (è¾“å‡ºå±‚) --- # å…¬å¼ï¼šdC/dw2 = (dC/da2) * (da2/dz2) * (dz2/dw2) dC_da2 = a2 - y # Loss å¯¹é¢„æµ‹å€¼çš„å¯¼æ•° da2_dz2 = a2 * (1 - a2) # Sigmoid å¯¼æ•° dz2_dw2 = a1 # å› ä¸º z2 = w2 * a1ï¼Œå¯¹ w2 æ±‚å¯¼å‰©ä¸‹ a1 grad_w2 = dC_da2 * da2_dz2 * dz2_dw2 # --- ç¬¬äºŒæ­¥ï¼šè®¡ç®— w1 çš„æ¢¯åº¦ (éšå«å±‚) --- # å…¬å¼ï¼šdC/dw1 = [(dC/da2) * (da2/dz2) * (dz2/da1)] * (dz1/dw1) * (da1/dz1) # æ–¹æ‹¬å·çš„å†…å®¹è¡¨ç¤ºåŠæˆå“a1çš„æ”¹å˜å¯¹æ€»æŸå¤±Cçš„å½±å“ dz2_da1 = w2 dz1_dw1 = x da1_dz1 = a1 * (1 - a1) # é“¾å¼ç›¸ä¹˜ï¼š(dC/da2 * da2/dz2) å³æ˜¯ä¸Šä¸€å±‚çš„è¯¯å·®ä¼ é€’ï¼Œå†ä¹˜ä»¥ (dz2/da1 * da1/dz1 * dz1/dw1) grad_w1 = dC_da2 * da2_dz2 * dz2_da1 * dz1_dw1 * da1_dz1 # --- C. æƒé‡æ›´æ–° --- w1 = w1 - learning_rate * grad_w1 w2 = w2 - learning_rate * grad_w2 # æ‰“å°æŸ¥çœ‹æ¯è½®çš„å˜åŒ– print(f\"Epoch {epoch + 1}: Loss = {C.item():.4f}, w1 = {w1.item():.4f}, w2 = {w2.item():.4f}\") å®Œæ•´è®­ç»ƒç¤ºä¾‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118import torchimport torch.nn as nnfrom torch.utils.data import DataLoader, ConcatDatasetfrom torchvision import transformsfrom PIL import Imageimport os# --- 1. æ•°æ®é›†å®šä¹‰ ---class MyData(torch.utils.data.Dataset): def __init__(self, root_dir, label_dir, transform=None): self.root_dir = root_dir self.label_dir = label_dir self.path = os.path.join(self.root_dir, self.label_dir) self.img_path = os.listdir(self.path) self.transform = transform # ants -&gt; 0, bees -&gt; 1 self.label = 0 if label_dir == \"ants\" else 1 def __getitem__(self, idx): img_name = self.img_path[idx] img_item_path = os.path.join(self.path, img_name) img = Image.open(img_item_path).convert(\"RGB\") # ä¿è¯ä¸‰é€šé“ if self.transform: img = self.transform(img) return img, self.label def __len__(self): return len(self.img_path)# --- 2. é…ç½®å˜æ¢ ---data_transforms = transforms.Compose( [ transforms.Resize((64, 64)), transforms.ToTensor(), transforms.Normalize([0.5, 0.5, 0.5], [0.2, 0.2, 0.2]), ])# --- 3. å‡†å¤‡åŠ è½½å™¨ ---train_root = r\"D:\\RecommendationSystem\\PyTorchå­¦ä¹ \\hymenoptera_data\\train\"val_root = r\"D:\\RecommendationSystem\\PyTorchå­¦ä¹ \\hymenoptera_data\\val\"# è®­ç»ƒé›†train_ants = MyData(train_root, \"ants\", transform=data_transforms)train_bees = MyData(train_root, \"bees\", transform=data_transforms)train_loader = DataLoader( ConcatDataset([train_ants, train_bees]), batch_size=8, shuffle=True)# éªŒè¯é›†val_ants = MyData(val_root, \"ants\", transform=data_transforms)val_bees = MyData(val_root, \"bees\", transform=data_transforms)val_loader = DataLoader( ConcatDataset([val_ants, val_bees]), batch_size=8, shuffle=False)# --- 4. æ¨¡å‹å®šä¹‰ ---class SimpleCNN(nn.Module): def __init__(self): super().__init__() self.model = nn.Sequential( nn.Conv2d(3, 16, 3, padding=1), nn.ReLU(), nn.MaxPool2d(2), nn.Flatten(), nn.Linear(16 * 32 * 32, 2), ) def forward(self, x): return self.model(x)device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")model = SimpleCNN().to(device)loss_fn = nn.CrossEntropyLoss()optimizer = torch.optim.SGD(model.parameters(), lr=0.01)# --- 5. è®­ç»ƒä¸è¯„ä¼°å¾ªç¯ ---for epoch in range(10): # è®­ç»ƒé˜¶æ®µ model.train() # åˆ‡æ¢åˆ°è®­ç»ƒæ¨¡å¼ train_loss = 0 for imgs, labels in train_loader: imgs, labels = imgs.to(device), labels.to(device) outputs = model(imgs) loss = loss_fn(outputs, labels) optimizer.zero_grad() loss.backward() optimizer.step() train_loss += loss.item() # è¯„ä¼°é˜¶æ®µ model.eval() # åˆ‡æ¢åˆ°è¯„ä¼°æ¨¡å¼ val_loss = 0 total_accuracy = 0 with torch.no_grad(): # è¯„ä¼°æ—¶ä¸è®¡ç®—æ¢¯åº¦ï¼ŒèŠ‚çœå†…å­˜å’Œè®¡ç®—é‡ for imgs, labels in val_loader: imgs, labels = imgs.to(device), labels.to(device) outputs = model(imgs) loss = loss_fn(outputs, labels) val_loss += loss.item() # è®¡ç®—å‡†ç¡®ç‡ predictions = outputs.argmax(1) # è·å–æ¦‚ç‡æœ€å¤§çš„ç±»åˆ«ç´¢å¼• total_accuracy += (predictions == labels).sum().item() avg_acc = total_accuracy / len(val_loader.dataset) print(f\"Epoch {epoch}: Train Loss: {train_loss:.3f}, Val Acc: {avg_acc:.2%}\")# --- 6. ä¿å­˜æ¨¡å‹ ---os.makedirs(\"models\", exist_ok=True)torch.save(model.state_dict(), \"models/best_model.pth\") æŸå¤±å‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import torchimport torch.nn as nn# è®¾ç½®éšæœºç§å­ä¿è¯ç»“æœå¯å¤ç°torch.manual_seed(42)# ==========================================# åœºæ™¯ Aï¼šå›å½’é—®é¢˜ (Regression)# å¸¸ç”¨ L1Loss æˆ– MSELoss# ==========================================# é¢„æµ‹å€¼ä¸çœŸå®å€¼predict = torch.tensor([1.0, 2.0, 3.0])target = torch.tensor([1.0, 2.0, 5.0])# 1. L1Loss: è®¡ç®—å¹³å‡ç»å¯¹è¯¯å·® (Mean Absolute Error, MAE)# å…¬å¼: sum(|predict - target|) / n = (0 + 0 + 2) / 3 = 0.6667loss_l1 = nn.L1Loss()res_l1 = loss_l1(predict, target)# 2. MSELoss: è®¡ç®—å‡æ–¹è¯¯å·® (Mean Squared Error)# å…¬å¼: sum((predict - target)^2) / n = (0^2 + 0^2 + 2^2) / 3 = 4 / 3 = 1.3333loss_mse = nn.MSELoss()res_mse = loss_mse(predict, target)print(\"--- å›å½’æŸå¤± (Regression Losses) ---\")print(f\"L1 Loss (MAE): {res_l1.item():.4f}\")print(f\"MSE Loss: {res_mse.item():.4f}\\n\")# ==========================================# åœºæ™¯ Bï¼šåˆ†ç±»é—®é¢˜ (Classification)# å¸¸ç”¨ CrossEntropyLoss# ==========================================# å‡è®¾æˆ‘ä»¬åœ¨åšä¸€ä¸ªä¸‰åˆ†ç±»ä»»åŠ¡ï¼ˆå¦‚ï¼šçŒ«ã€ç‹—ã€çŒªï¼‰# è¾“å…¥ x: æ¨¡å‹ç»™å‡ºçš„æ¯ä¸ªç±»åˆ«çš„å¾—åˆ† (Logits)ï¼Œå½¢çŠ¶ä¸º (æ ·æœ¬æ•°, ç±»åˆ«æ•°)# ç›®æ ‡ y: çœŸå®ç±»åˆ«çš„ç´¢å¼• (Index)ï¼Œå½¢çŠ¶ä¸º (æ ·æœ¬æ•°)x = torch.tensor([[0.1, 0.2, 0.3]]) # æ¨¡å‹é¢„æµ‹å„ç±»çš„â€œä¿¡å¿ƒâ€y = torch.tensor([1]) # çœŸå®æ ‡ç­¾æ˜¯ç´¢å¼• 1 (æ¯”å¦‚â€œç‹—â€)# CrossEntropyLoss ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åš Softmax + Log + NLLLossloss_ce = nn.CrossEntropyLoss()res_ce = loss_ce(x, y)\"\"\"å¯¹ç½‘ç»œè¾“å‡ºçš„æ ·æœ¬åˆ†æ•°ä½¿ç”¨softmaxè½¬æ¢æˆæ¦‚ç‡å¯¹çœŸå®æ ‡ç­¾ä¸‹çš„é¢„æµ‹æ ·æœ¬å–è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼Œå³ä¸ºæŸå¤±\"\"\"print(\"--- åˆ†ç±»æŸå¤± (Classification Loss) ---\")print(f\"CrossEntropy Loss: {res_ce.item():.4f}\")","categories":[{"name":"ç®—æ³•å­¦ä¹ ","slug":"ç®—æ³•å­¦ä¹ ","permalink":"http://example.com/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://example.com/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"}]},{"title":"æ•°æ®æŒ–æ˜å­¦ä¹ ç¬”è®°ï¼šæœ´ç´ è´å¶æ–¯","slug":"æ•°æ®æŒ–æ˜å­¦ä¹ ç¬”è®°ï¼šæœ´ç´ è´å¶æ–¯","date":"2026-01-04T14:12:08.000Z","updated":"2026-01-13T13:53:11.846Z","comments":true,"path":"2026/01/04/æ•°æ®æŒ–æ˜å­¦ä¹ ç¬”è®°ï¼šæœ´ç´ è´å¶æ–¯/","permalink":"http://example.com/2026/01/04/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/","excerpt":"æœ¬æ–‡è®°å½•äº†æˆ‘å¯¹æœ´ç´ è´å¶æ–¯çš„å­¦ä¹ è¿‡ç¨‹ï¼ŒåŒ…å«ç®—æ³•çš„æ¨å¯¼å’Œä»£ç å®ç°ã€‚","text":"æœ¬æ–‡è®°å½•äº†æˆ‘å¯¹æœ´ç´ è´å¶æ–¯çš„å­¦ä¹ è¿‡ç¨‹ï¼ŒåŒ…å«ç®—æ³•çš„æ¨å¯¼å’Œä»£ç å®ç°ã€‚ æœºå™¨å­¦ä¹ ç³»åˆ—ï¼ˆå››ï¼‰ï¼šæœ´ç´ è´å¶æ–¯ï¼ˆåå¼ºä¹°ç“œç‰ˆï¼‰ - yyxyçš„æ–‡ç«  - çŸ¥ä¹ ååˆ†é’Ÿï¼Œè®©ä½ å†ä¹Ÿå¿˜ä¸æ‰è´å¶æ–¯åˆ†ç±» - VoidHaruhiçš„æ–‡ç«  - çŸ¥ä¹ ã€Šæœºå™¨å­¦ä¹ ã€‹ï¼ˆè¥¿ç“œä¹¦ï¼‰å…¬å¼è¯¦è§£ ã€åƒç“œæ•™ç¨‹ã€‘ã€Šæœºå™¨å­¦ä¹ å…¬å¼è¯¦è§£ã€‹ï¼ˆå—ç“œä¹¦ï¼‰ä¸è¥¿ç“œä¹¦å…¬å¼æ¨å¯¼ åˆ°åº•è¦å¦‚ä½•ç†è§£æ¡ä»¶æ¦‚ç‡ï¼Ÿ - çŸ³æºªçš„å›ç­” - çŸ¥ä¹ å¦‚ä½•åœ¨ Python ä¸­ä»é›¶å¼€å§‹å®ç°æœ´ç´ è´å¶æ–¯ æ•°æ®æŒ–æ˜å­¦ä¹ ç¬”è®°ï¼šæœ´ç´ è´å¶æ–¯ è´å¶æ–¯å†³ç­–è®º å‡è®¾å½“å‰æœ‰ä¸€ä¸ª åˆ†ç±»ä»»åŠ¡ï¼Œå³ ï¼Œå°† å®šä¹‰ä¸ºå°†ä¸€ä¸ªçœŸå®æ ‡è®° çš„æ ·æœ¬è¯¯åˆ†ç±»ä¸º æ‰€äº§ç”Ÿçš„æŸå¤±ã€‚å¦‚æœå…¶ç›®æ ‡ä¸ºæœ€å°åŒ–åˆ†ç±»é”™è¯¯ç‡ï¼Œåˆ™æŸå¤± å¯å†™ä¸ºï¼š ï¼Œï¼Œï¼Œ æ­¤æ—¶ï¼Œå¯¹äºå•ä¸ªæ ·æœ¬ è€Œè¨€ï¼Œå®šä¹‰å…¶æœŸæœ›æŸå¤±ä¸ºå¦‚ä¸‹æ¡ä»¶é£é™©çš„å½¢å¼ï¼š ä¸Šå¼ä¸­ï¼Œ ä¸ºåéªŒæ¦‚ç‡ã€‚ é‚£ä¹ˆï¼Œè´å¶æ–¯å†³ç­–è®ºçš„ä»»åŠ¡å°±æ˜¯å»å¯»æ‰¾ä¸€ä¸ªåˆ¤å®šå‡†åˆ™ ï¼Œä»¥æœ€å°åŒ–å…¨éƒ¨æ ·æœ¬æ„æˆçš„æ€»ä½“é£é™©ï¼š åœ¨å®šä¹‰å®Œä¸Šè¿°æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼•å…¥è´å¶æ–¯åˆ¤å®šå‡†åˆ™ï¼Œå³æœ€å°åŒ–æ€»ä½“é£é™© ã€‚å› æ­¤ï¼Œåªéœ€åœ¨æ¯ä¸ªæ ·æœ¬ä¸Šé€‰æ‹©é‚£ä¸ªèƒ½ä½¿æ¡ä»¶é£é™© æœ€å°çš„ç±»åˆ«æ ‡è®°ï¼š æ­¤æ—¶ï¼Œ è¢«ç§°ä¸ºè´å¶æ–¯æœ€ä¼˜åˆ†ç±»å™¨ï¼ˆBayes optimal classifierï¼‰ã€‚ å¯¹å…¬å¼å±•å¼€å¾—ï¼š å¯¹äºä¸€ä¸ª åˆ†ç±»ä»»åŠ¡è€Œè¨€ï¼Œæ‰€æœ‰ç±»åˆ«é¢„æµ‹çš„æ¦‚ç‡æ€»å’Œä¸€å®šä¸º 1ï¼Œå³ï¼š æ­¤æ—¶ï¼Œæ¡ä»¶é£é™©å¯åŒ–ç®€ä¸ºï¼š äºæ˜¯ï¼Œæœ€å°åŒ–åˆ†ç±»é”™è¯¯ç‡çš„è´å¶æ–¯æœ€ä¼˜åˆ†ç±»å™¨å¯å†™ä¸ºï¼š å¯¹æ¯ä¸ªæ ·æœ¬ ï¼Œé€‰æ‹©èƒ½ä½¿åéªŒæ¦‚ç‡ æœ€å¤§çš„ç±»åˆ«æ ‡è®°ã€‚ ç”Ÿæˆå¼æ¨¡å‹ä¸åˆ¤åˆ«å¼æ¨¡å‹ å¦‚ SVM è¿™æ ·çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå…¶æœ¬è´¨æ˜¯åœ¨ç‰¹å¾ç©ºé—´å†…å¯»æ‰¾ä¸€ä¸ªè¶…å¹³é¢æŠŠç±»åˆ«æ ·æœ¬åˆ’åˆ†å¼€ï¼Œæ˜¯ä¸€ä¸ªä»å‡ ä½•è§’åº¦æ€è€ƒçš„æ¨¡å‹ï¼Œå¹¶æ²¡æœ‰æ¶‰åŠæ¦‚ç‡çš„è®¡ç®—ã€‚æ‰€è°“åˆ¤åˆ«å¼æ¨¡å‹ï¼Œå°±æ˜¯ç›´æ¥å¯¹åéªŒæ¦‚ç‡è¿›è¡Œå»ºæ¨¡ï¼Œæ±‚å‡ºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡è¿›è¡Œåˆ†ç±»ã€‚ä¸‹é¢è¦å°†çš„æœ´ç´ è´å¶æ–¯åˆ™å±äºç”Ÿæˆå¼æ¨¡å‹ï¼Œå…¶å…ˆå¯¹è”åˆæ¦‚ç‡å…ˆè¿›è¡Œå»ºæ¨¡ï¼Œå†æ¨å¯¼å‡ºåéªŒæ¦‚ç‡ï¼Œå³ï¼š å…¬å¼æ˜¯å¾ˆç®€å•çš„æ¡ä»¶æ¦‚ç‡ä¸€èˆ¬å®šä¹‰ï¼Œå¯ä»¥ä»å¤å…¸æ¦‚å‹è¿›è¡Œæ¨å¯¼ã€‚ å‡å®šä¸€ä¸ªè¯•éªŒæœ‰ ä¸ªç­‰å¯èƒ½çš„ç»“æœï¼Œäº‹ä»¶ å’Œ åˆ†åˆ«åŒ…å« ä¸ªå’Œ ä¸ªç»“æœï¼Œè¿™å…¶ä¸­æœ‰ ä¸ªç»“æœæ˜¯å…¬å…±çš„ï¼Œè¿™å°±æ˜¯åŒæ—¶å‘ç”Ÿäº‹ä»¶ å’Œäº‹ä»¶ ï¼Œå³ äº‹ä»¶æ‰€åŒ…å«çš„è¯•éªŒç»“æœæ•°ã€‚ é‚£ä¹ˆå·²çŸ¥åœ¨äº‹ä»¶ å‘ç”Ÿçš„å‰ææ¡ä»¶ä¸‹ï¼Œäº‹ä»¶ å‘ç”Ÿçš„æ¦‚ç‡ä¸ºï¼š å¯¹äºä¸Šå¼ï¼Œå¯ä»¥è¿›è¡Œå±•å¼€ï¼š æ•…å¯ä»¥å¾—åˆ°æ¡ä»¶æ¦‚ç‡çš„ä¸€èˆ¬å®šä¹‰ï¼š â€‹å›åˆ°å…¬å¼ï¼Œç”¨è´å¶æ–¯å®šç†å¯ä»¥æ’ç­‰å˜å½¢ä¸ºï¼š å…¶ä¸­ï¼Œ æ˜¯å…ˆéªŒæ¦‚ç‡ï¼Œ æ˜¯æ ·æœ¬ ç›¸å¯¹äºç±»åˆ«æ ‡è®°æ˜¯ç±»æ¡ä»¶æ¦‚ç‡ï¼Œä¹Ÿå«ä¼¼ç„¶ï¼Œ æ˜¯å½’ä¸€åŒ–ç”¨çš„è¯æ®å› å­ã€‚ åœ¨å…¬å¼ä¸­æœ€éš¾å»ºæ¨¡çš„æ˜¯ç±»æ¡ä»¶æ¦‚ç‡ï¼Œå‡å¦‚æ ·æœ¬ æœ‰ ä¸ªç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾åˆæœ‰å¤šä¸ªå–å€¼ï¼Œé‚£ä¹ˆæ ·æœ¬ç›¸å¯¹äºç±»åˆ« çš„ç»„åˆæ•°ä¸èƒœæ•°ï¼Œç”šè‡³åœ¨æ•°æ®é›†ä¸­éƒ½æ²¡æœ‰è¿™ç§ç»„åˆã€‚é‚£å¦‚ä½•æŠŠè¿™ä¸ªç±»æ¡ä»¶æ¦‚ç‡è®¡ç®—å‡ºæ¥å‘¢ï¼Ÿæœ´ç´ è´å¶æ–¯ç»™äº†è¿™ä¹ˆä¸€ç§æ–¹æ³•ã€‚ æœ´ç´ è´å¶æ–¯ æœ´ç´ è´å¶æ–¯å‡è®¾å¯¹äºå·²çŸ¥ç±»åˆ«ï¼Œå„ä¸ªå±æ€§ç›¸äº’ç‹¬ç«‹ï¼Œå³æ»¡è¶³å±æ€§æ¡ä»¶ç‹¬ç«‹æ€§å‡è®¾ã€‚é‚£ä¹ˆåéªŒæ¦‚ç‡å¯ä»¥å†™æˆï¼š å…¶ä¸­ï¼Œ ä¸ºå±æ€§æ•°ç›®ï¼Œ è¡¨ç¤º åœ¨ç¬¬ ä¸ªå±æ€§ä¸Šçš„å–å€¼ã€‚åŸºäºè´å¶æ–¯åˆ¤å®šå‡†åˆ™å¯å¾—ï¼š ç»¼ä¸Šæ‰€è¿°ï¼Œæ ·æœ¬æ‰€å±çš„å“ªä¸ªç±»åˆ«çš„åéªŒæ¦‚ç‡æœ€å¤§ï¼Œå°±é€‰æ‹©å“ªä¸ªç±»åˆ«ä½œä¸ºæ¨¡å‹ çš„é¢„æµ‹ç»“æœã€‚é‚£ä¹ˆï¼Œç°åœ¨çš„é—®é¢˜å°±æ˜¯ï¼Œå¦‚ä½•è®¡ç®—ç±»æ¡ä»¶æ¦‚ç‡å’Œå…ˆéªŒæ¦‚ç‡ï¼Œæ‰èƒ½ä½¿å¾—æ¨¡å‹é¢„æµ‹å¾—æœ€å‡†ï¼Œå³æ¡ä»¶é£é™©æœ€å°ã€‚ å¯¹äºå…ˆéªŒæ¦‚ç‡çš„è®¡ç®—å¾ˆç®€å•ï¼Œåˆ©ç”¨å¤§æ•°å®šç†ï¼Œåœ¨è®­ç»ƒé›†æ ·æœ¬è¶³å¤Ÿå¤šçš„æƒ…å†µä¸‹ç”¨é¢‘ç‡è¿‘ä¼¼æ¦‚ç‡ï¼š å…¶ä¸­ï¼Œ è¡¨ç¤ºè®­ç»ƒé›† ä¸­ç±»åˆ«æ ‡è®°ä¸ºçš„æ ·æœ¬é›†åˆï¼Œ è¡¨ç¤ºé›†åˆ çš„æ ·æœ¬æ€»æ•°ã€‚ å¯¹äºç±»æ¡ä»¶æ¦‚ç‡çš„è®¡ç®—è¦åˆ†æˆä¸¤ç§æƒ…å†µè®¨è®ºï¼šç¦»æ•£å±æ€§å’Œè¿ç»­å±æ€§ã€‚å¯¹äºç¦»æ•£å±æ€§çš„ç±»æ¡ä»¶æ¦‚ç‡è®¡ç®—æ€è·¯å’Œå…¬å¼ä¸€æ ·ï¼Œå› æ­¤ç¬¬ ä¸ªå±æ€§ä¸ºç¦»æ•£å±æ€§çš„ç±»æ¡ä»¶æ¦‚ç‡ä¸ºï¼š å…¶ä¸­ï¼Œ è¡¨ç¤º åœ¨ç¬¬ä¸ªå±æ€§ä¸Šå–å€¼ä¸º çš„æ ·æœ¬ç»„æˆçš„é›†åˆã€‚ ç„¶è€Œï¼Œå¦‚æœæŸä¸ªå±æ€§å€¼åœ¨è®­ç»ƒé›†ä¸­æ²¡æœ‰ä¸æŸä¸ªç±»åˆ«åŒæ—¶å‡ºç°è¿‡ï¼Œç›´æ¥ä½¿ç”¨å…¬å¼è®¡ç®—ï¼Œåˆ™ä¼šè®©è¿ä¹˜å¼å­ç»“æœä¸º 0ã€‚ä¸ºé¿å…å‡ºç°è¿™ç§æƒ…å†µï¼Œåœ¨ä¼°è®¡æ¦‚ç‡å€¼æ—¶åº”è¯¥åŠ ä»¥å¹³æ»‘ï¼ŒæŒ‰ã€Šè¥¿ç“œä¹¦ã€‹çš„ç¤ºä¾‹ï¼Œä½¿ç”¨æ‹‰æ™®æ‹‰æ–¯ä¿®æ­£ï¼š å…¶ä¸­ï¼Œ è¡¨ç¤ºç±»åˆ«æ•°é‡ï¼Œ è¡¨ç¤ºç¬¬ ä¸ªå±æ€§å‡ºç°çš„å–å€¼æ•°é‡ã€‚ å¯¹äºè¿ç»­å±æ€§ï¼Œå‡è®¾æ»¡è¶³æ­£æ€åˆ†å¸ƒï¼Œé‚£ä¹ˆå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š å…¶ä¸­ï¼Œ å’Œ åˆ†åˆ«è¡¨ç¤ºç¬¬ ç±»æ ·æœ¬åœ¨ç¬¬ ä¸ªå±æ€§ä¸Šå–å€¼çš„å‡å€¼å’Œæ–¹å·®ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡å»ä¼°è®¡å…¶å‡å€¼å’Œæ–¹å·®ã€‚å…¬å¼ä¸ºä¸€å…ƒæ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œä¸‹é¢å¯¹äºå¤šå…ƒæ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•° è€Œè¨€ï¼Œå…¶ç­‰ä»·å½¢å¼ä¸ºï¼š å…¶ä¸­ï¼Œ è¡¨ç¤º çš„ç»´æ•°ï¼Œ ä¸ºæ­£å®šåæ–¹å·®çŸ©é˜µã€‚ å¯¹æ•°æå¤§ä¼¼ç„¶ä¼°è®¡çš„å‚æ•°æ±‚è§£å½¢å¼ä¸ºï¼š é€šè¿‡æå¤§ä¼¼ç„¶ä¼°è®¡çš„å‡å€¼å’Œæ–¹å·®å¦‚ä¸‹ï¼š è¯¦ç»†çš„æ¨å¯¼è¿‡ç¨‹è§å—ç“œä¹¦ç¬¬ 63~64 é¡µã€‚ å‡å¦‚è¯´ï¼Œå°†æœ´ç´ è´å¶æ–¯åº”ç”¨äºä½ çš„æ•°æ®é›†ä¸Šå‘ç°æ•ˆæœå¹¶ä¸ç†æƒ³ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘æ›´æ¢æ¦‚ç‡åˆ†å¸ƒï¼Œè¿™æˆ–è®¸å¯ä»¥çœ‹ä½œæ˜¯è´å¶æ–¯åˆ†ç±»çš„è¶…å‚æ•°ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰å¯èƒ½æ•°æ®é›†ä¸Šçš„å„ä¸ªå±æ€§ä¸ç‹¬ç«‹ã€‚ å®ç°ä»£ç  ä»£ç ä¸­ä½¿ç”¨çš„æ•°æ®é›†æ¥è‡ªå’Œé²¸ç¤¾åŒºï¼šçš®é©¬å°ç¬¬å®‰äººç³–å°¿ç—…æ•°æ®åº“ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687import mathimport pandas as pd# çš®é©¬å°ç¬¬å®‰äººç³–å°¿ç—…æ•°æ®train_data = pd.read_csv(r'train_data.csv').valuestest_data = pd.read_csv(r'test_data.csv').values# åˆ’åˆ†è¿ç»­å’Œç¦»æ•£å‹å˜é‡continuous_columns = [1, 2, 3, 4, 5, 6] # Glucose, BloodPressure, SkinThickness, Insulin, BMI, DiabetesPedigreeFunctiondiscrete_columns = [0, 7] # Pregnancies, Age# å°†æ•°æ®æŒ‰ç±»åˆ«åˆ†ç¦»separated_data = {0: [], 1: []} # åˆ›å»ºä¸€ä¸ªç©ºå­—å…¸ç”¨æ¥å­˜å‚¨ä¸¤ä¸ªç±»åˆ«ä¸‹çš„æ ·æœ¬for row in train_data: class_label = row[-1] # è·å–ç±»åˆ«åˆ— separated_data[class_label].append(row) # æŠŠç›¸åŒç±»åˆ«ä¸‹çš„æ ·æœ¬æ”¾åˆ°ä¸€èµ·# åˆ†åˆ«è®¡ç®—ä¸¤ä¸ªç±»åˆ«ä¸‹æ¯ä¸ªè¿ç»­å˜é‡çš„å‡å€¼å’Œæ ‡å‡†å·®ã€å’Œç¦»æ•£å˜é‡çš„é¢‘ç‡class_summaries = {} # åˆ›å»ºä¸€ä¸ªç©ºå­—å…¸ç”¨æ¥å­˜å‚¨ä¸¤ä¸ªç±»åˆ«ä¸‹è¿ç»­å˜é‡å’Œç¦»æ•£å˜é‡çš„ç»Ÿè®¡ä¿¡æ¯for class_label, rows in separated_data.items(): summaries = {} # è¿ç»­å‹å˜é‡çš„å‡å€¼å’Œæ ‡å‡†å·® continuous_summaries = [] for col_idx in continuous_columns: column = [row[col_idx] for row in rows] # æŠŠè¿ç»­å˜é‡çš„ä¸€æ•´åˆ—æå–å‡ºæ¥ mean_val = sum(column) / len(column) # è®¡ç®—å‡å€¼ Î¼_c variance = sum([(x - mean_val) ** 2 for x in column]) / len(column) # è®¡ç®—æ–¹å·® Ïƒ_c^2 stdev_val = math.sqrt(variance) # è®¡ç®—æ ‡å‡†å·® Ïƒ_c continuous_summaries.append((mean_val, stdev_val)) # ç¦»æ•£å‹å˜é‡çš„é¢‘ç‡è®¡ç®— discrete_summaries = [] for col_idx in discrete_columns: column = [row[col_idx] for row in rows] # æŠŠç¦»æ•£å˜é‡çš„ä¸€æ•´åˆ—æå–å‡ºæ¥ value_counts = {val: column.count(val) for val in set(column)} # ç»Ÿè®¡ç¦»æ•£å˜é‡ä¸­æ¯ä¸ªå–å€¼å‡ºç°çš„ä¸ªæ•°ï¼ŒåŠ 1æ˜¯æ‹‰æ™®æ‹‰æ–¯ä¿®æ­£ total_count = len(rows) discrete_summaries.append((value_counts, total_count)) # å­˜å‚¨ä¸¤ä¸ªç±»åˆ«ä¸‹è¿ç»­å‹å’Œç¦»æ•£å‹çš„ç‰¹å¾ç»Ÿè®¡ä¿¡æ¯ summaries['continuous'] = continuous_summaries summaries['discrete'] = discrete_summaries class_summaries[class_label] = summaries# æ‹‰æ™®æ‹‰æ–¯ä¿®æ­£åçš„å…ˆéªŒæ¦‚ç‡class_prior = {}total_samples = len(train_data) # æ ·æœ¬é•¿åº¦ |D|num_classes = len(class_summaries) # ç±»åˆ«æ•° Nfor class_label in separated_data: # å–å‡ºä¸¤ä¸ªç±»åˆ«çš„æ ·æœ¬ class_count = len(separated_data[class_label]) # ä¸¤ä¸ªç±»åˆ«å„è‡ªçš„æ ·æœ¬æ•°é‡ |D_c| class_prior[class_label] = (class_count + 1) / (total_samples + num_classes)# åˆ†ç±»predictions = []for row in test_data: # å¯¹æµ‹è¯•é›†çš„æ¯ä¸€ä¸ªæ ·æœ¬è¿›è¡Œåˆ†ç±» probabilities = {} for class_label, summaries in class_summaries.items(): # ä¸¤ä¸ªç±»åˆ«ä¸‹è¿ç»­å˜é‡å’Œç¦»æ•£å˜é‡çš„ç»Ÿè®¡ä¿¡æ¯ # å°†ç¬¬ä¸€ä¸ªç±»æ¡ä»¶æ¦‚ç‡åˆå§‹åŒ–ä¸ºå…ˆéªŒæ¦‚ç‡ probabilities[class_label] = class_prior[class_label] # è¿ç»­å˜é‡çš„ç±»æ¡ä»¶æ¦‚ç‡ for i, (mean_val, stdev_val) in enumerate(summaries['continuous']): x = row[continuous_columns[i]] # æµ‹è¯•é›†æ¯ä¸ªæ ·æœ¬ä¸­æ¯ä¸ªè¿ç»­å˜é‡çš„å–å€¼ exponent = math.exp(-((x - mean_val) ** 2 / (2 * stdev_val ** 2))) continous_probability = (1 / (math.sqrt(2 * math.pi) * stdev_val)) * exponent probabilities[class_label] *= continous_probability # ç¦»æ•£å˜é‡çš„ç±»æ¡ä»¶æ¦‚ç‡ for i, (value_counts, total_count) in enumerate(summaries['discrete']): x = row[discrete_columns[i]] num_values = len(value_counts) # å˜é‡å–å€¼çš„æ•°é‡ N_i discrete_probability = (value_counts.get(x, 0) + 1) / (total_count + num_values) # æ‹‰æ™®æ‹‰æ–¯ä¿®æ­£ probabilities[class_label] *= discrete_probability # è®¡ç®—å½’ä¸€åŒ–å› å­ P(x) total_probability = sum(probabilities.values()) for class_label in probabilities: probabilities[class_label] /= total_probability best_class = max(probabilities, key=probabilities.get) # çœ‹çœ‹å“ªä¸ªç±»åˆ«çš„åéªŒæ¦‚ç‡å¤§ predictions.append(best_class)# è®¡ç®—å‡†ç¡®ç‡correct_predictions = sum(1 for i in range(len(test_data)) if test_data[i][-1] == predictions[i])accuracy = (correct_predictions / len(test_data)) * 100.0print(f'code_accuracy: {accuracy:.4f}%') åŠæœ´ç´ è´å¶æ–¯ æœ´ç´ è´å¶æ–¯æ˜¯åŸºäºå„å±æ€§éƒ½ç›¸äº’ç‹¬ç«‹çš„å‡è®¾è¿›è¡Œçš„ï¼Œä½†ç°å®ç”Ÿæ´»ä¸­å¹¶æ²¡æœ‰å¦‚æ­¤ç†æƒ³ã€‚åŠæœ´ç´ è´å¶æ–¯åˆ™é€‚å½“è€ƒè™‘ä¸€éƒ¨åˆ†å±æ€§é—´çš„ç›¸äº’ä¾èµ–ä¿¡æ¯ï¼Œä»è€Œæ—¢ä¸éœ€è¿›è¡Œå®Œå…¨è”åˆæ¦‚ç‡è®¡ç®—ï¼Œåˆä¸è‡³äºå½»åº•å¿½ç•¥äº†æ¯”è¾ƒå¼ºçš„å±æ€§ä¾èµ–å…³ç³»ã€‚ å›é¡¾å…¬å¼ï¼Œæœ´ç´ è´å¶æ–¯çš„ç±»æ¡ä»¶æ¦‚ç‡è€ƒè™‘çš„æ˜¯åªä¸ä¸€ä¸ªå±æ€§ æœ‰å…³ï¼Œè€ŒåŠæœ´ç´ è´å¶æ–¯ä¸ä»…è€ƒè™‘å±æ€§ ï¼Œè¿˜è€ƒè™‘å…¶ä»–çš„ä¸€ä¸ªå±æ€§ï¼Œå³ç‹¬ä¾èµ–ä¼°è®¡ï¼ˆODEï¼‰ï¼š å…¶ä¸­ï¼Œ è¡¨ç¤ºå±æ€§ æ‰€ä¾èµ–çš„å±æ€§ï¼Œç§°ä¸º çš„çˆ¶å±æ€§ã€‚ å¯¹äºå¦‚ä½•ç¡®å®šçˆ¶å±æ€§ï¼Œæœ€ç›´æ¥çš„åšæ³•æ˜¯å‡è®¾æ‰€æœ‰å±æ€§éƒ½ä¾èµ–äºåŒä¸€ä¸ªå±æ€§ï¼Œå³è¶…çˆ¶ç‹¬ä¾èµ–ä¼°è®¡ï¼ˆSPODEï¼‰ï¼š å…¶ä¸­ï¼Œ ä¸ºè¶…çˆ¶å±æ€§ã€‚","categories":[{"name":"ç®—æ³•å­¦ä¹ ","slug":"ç®—æ³•å­¦ä¹ ","permalink":"http://example.com/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://example.com/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"}]},{"title":"ã€ŠOptimal Discriminant Support Vector Machineã€‹é˜…è¯»ç¬”è®°","slug":"Optimal-Discriminant-Support-Vector-Machineé˜…è¯»ç¬”è®°","date":"2026-01-04T11:58:29.000Z","updated":"2026-01-04T16:03:05.772Z","comments":true,"path":"2026/01/04/Optimal-Discriminant-Support-Vector-Machineé˜…è¯»ç¬”è®°/","permalink":"http://example.com/2026/01/04/Optimal-Discriminant-Support-Vector-Machine%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/","excerpt":"æœ¬æ–‡æ˜¯å¯¹ã€ŠOptimal Discriminant Support Vector Machineã€‹è¿™ç¯‡æ–‡ç« çš„é˜…è¯»ç¬”è®°ï¼Œæ¨å¯¼äº†äºŒåˆ†ç±»æƒ…æ™¯ä¸‹æ–‡ç« æ‰€ææ¨¡å‹ç›®æ ‡å‡½æ•°çš„è®¾è®¡å’Œæ±‚è§£è¿‡ç¨‹ã€‚","text":"æœ¬æ–‡æ˜¯å¯¹ã€ŠOptimal Discriminant Support Vector Machineã€‹è¿™ç¯‡æ–‡ç« çš„é˜…è¯»ç¬”è®°ï¼Œæ¨å¯¼äº†äºŒåˆ†ç±»æƒ…æ™¯ä¸‹æ–‡ç« æ‰€ææ¨¡å‹ç›®æ ‡å‡½æ•°çš„è®¾è®¡å’Œæ±‚è§£è¿‡ç¨‹ã€‚ Zhang, J., Lai, Z., Kong, H., &amp; Yang, J. (2025). Learning the optimal discriminant SVM with feature extraction. IEEE Transactions on Pattern Analysis and Machine Intelligence, 47(4), 2897â€“2911. https://doi.org/10.1109/TPAMI.2025.3529711. æ¨¡å‹æ€»è§ˆ ODSVM å°†å­ç©ºé—´å­¦ä¹ å’Œ SVM åˆ†ç±»æ”¾åœ¨ä¸€ä¸ªç»Ÿä¸€çš„æ•°å­¦æ¡†æ¶å†…å…±åŒè¿›åŒ–ã€‚ æŠ•å½±çŸ©é˜µï¼šæ•°æ®çš„ç‰¹å¾æå–å™¨ æ˜¯ä¸€ä¸ªå¤§å°ä¸º çš„çŸ©é˜µï¼ˆ æ˜¯åŸå§‹é«˜ç»´ç‰¹å¾ç»´åº¦ï¼Œ æ˜¯é™ç»´åçš„ç»´åº¦ï¼‰ã€‚å®ƒçš„ä½œç”¨æ˜¯å°†åŸå§‹æ ·æœ¬ æŠ•å½±åˆ°ä½ç»´å­ç©ºé—´ï¼š çš„ç›®æ ‡åœ¨äºä¸¢å¼ƒå¤§éƒ¨åˆ†å†—ä½™ä¿¡æ¯çš„åŒæ—¶ï¼Œç²¾å‡†åœ°ä¿ç•™æœ€æœ‰åˆ©äºåˆ†ç±»çš„ä¿¡æ¯ã€‚åœ¨ ODSVM ä¸­ï¼Œ çš„æ„å»ºå—åˆ° SVM è¾¹è·æœ€å¤§åŒ–çš„çº¦æŸã€‚è¿™æ„å‘³ç€ æå–å‡ºçš„ç‰¹å¾ å¿…é¡»è®© SVM èƒ½å¤Ÿæ›´å®¹æ˜“åœ°æ‰¾åˆ°ä¸€ä¸ªå®½é˜”çš„åˆ†ç±»é—´éš”ï¼ˆMarginï¼‰ã€‚ é‡æ„çŸ©é˜µï¼šæ•°æ®çš„ç»“æ„ä¿æŒå™¨ åŒæ ·æ˜¯ä¸€ä¸ª çš„çŸ©é˜µï¼Œç”¨äºè¡¡é‡æŠ•å½±åçš„ä½ç»´ç‰¹å¾ æ˜¯å¦è¿˜ä¿ç•™äº†åŸå§‹æ•°æ® çš„æ ¸å¿ƒç»“æ„ã€‚æ•°å­¦ä¸Šè¡¨ç°ä¸ºæœ€å°åŒ–é‡æ„è¯¯å·®ï¼šã€‚ å¦‚æœåªè¿½æ±‚åˆ†ç±»å‡†ç¡®ç‡ï¼ˆåªä¼˜åŒ– å’Œ SVM å‚æ•°ï¼‰ï¼Œæ¨¡å‹å¯èƒ½ä¼šé™·å…¥è¿‡æ‹Ÿåˆï¼Œæˆ–è€…æå–å‡ºæå…¶æ‰­æ›²çš„ç‰¹å¾ã€‚ çš„å­˜åœ¨å°±åƒæ˜¯ä¸€æ¡ç»³å­ï¼Œæ‹‰ä½ ï¼Œè¦æ±‚æå–çš„ç‰¹å¾ä¸ä»…è¦èƒ½åˆ†å¾—å¼€ç±»åˆ«ï¼Œè¿˜å¾—èƒ½ä»£è¡¨åŸæœ¬çš„æ•°æ®ã€‚ è¿­ä»£ä¼˜åŒ– åœ¨ ODSVM çš„ç›®æ ‡å‡½æ•°ä¸­ï¼ŒSVM çš„å‚æ•°ï¼ˆï¼‰ã€æŠ•å½±çŸ©é˜µ å’Œé‡æ„çŸ©é˜µ æ˜¯ç´§å¯†è€¦åˆåœ¨ä¸€èµ·çš„ã€‚ç”±äºæ— æ³•ç›´æ¥æ±‚å‡ºæ‰€æœ‰å˜é‡çš„æœ€ä¼˜è§£ï¼Œå› æ­¤è®ºæ–‡é‡‡ç”¨äº¤æ›¿è¿­ä»£ä¼˜åŒ–ï¼ˆAlternating Optimizationï¼‰çš„ç­–ç•¥ã€‚ ç¬¬ä¸€æ­¥ï¼šå›ºå®š å’Œ ï¼Œä¼˜åŒ– SVMï¼Œæ‰¾æœ€å¼ºåˆ¤åˆ«å¹³é¢ æ­¤æ—¶ï¼Œ å·²ç»æŠŠæ•°æ®å˜æˆäº†ä½ç»´ç‰¹å¾ ã€‚æ¨¡å‹é€€åŒ–æˆä¸€ä¸ªæ ‡å‡†çš„ SVM é—®é¢˜ã€‚å½“å‰çš„å­ç©ºé—´é‡Œï¼Œæ‰¾åˆ°èƒ½æŠŠä¸åŒç±»åˆ«åˆ†å¾—æœ€å¼€çš„è¶…å¹³é¢ ã€‚ ç¬¬äºŒæ­¥ï¼šå›ºå®š SVM å‚æ•°å’Œ ï¼Œä¼˜åŒ– éœ€è¦åŒæ—¶æ»¡è¶³ä¸¤ä¸ªè¦æ±‚ï¼šSVM è¦æ±‚æŠ•å½± å¾—è®©å®ƒçš„åˆ†ç±»é—´éš”æ›´å¤§ï¼Œ è¦æ±‚æŠ•å½± è¦èƒ½é…åˆé‡æ„çŸ©é˜µæ›´å¥½åœ°è¿˜åŸå› ã€‚åœ¨è¿™ç§çº¦æŸä¸‹ï¼Œ ä¼šè¢«å¾®è°ƒï¼Œä½¿å¾—æŠ•å½±åçš„æ•°æ®ç‚¹åœ¨ä¿æŒç»“æ„çš„åŒæ—¶ï¼Œå‘ç€æ›´æœ‰åˆ©äºåˆ†ç±»çš„æ–¹å‘åç§»ã€‚ ç¬¬ä¸‰æ­¥ï¼šå›ºå®š å’Œ SVMï¼Œä¼˜åŒ– ç”±äº å·²ç»å˜äº†ï¼ŒåŸæ¥çš„æ¢å¤æ–¹æ¡ˆ å¯èƒ½ä¸å†å‡†ç¡®ã€‚è¿™ä¸€æ­¥æ›´æ–° ï¼Œä½¿å¾—å®ƒèƒ½æ ¹æ®æ–°çš„ä½ç»´ç‰¹å¾ æ›´å¥½åœ°é‡å»ºåŸå§‹æ•°æ®ã€‚ å›¾æ­£åˆ™åŒ–é‡æ„ ODSVM å¹¶ä¸æ˜¯ç›´æ¥æœ€å°åŒ–ä½ç»´ç‚¹çš„è·ç¦»ï¼Œè€Œæ˜¯é€šè¿‡æœ€å°åŒ–é‚»å±…ç¼–ç è¯¯å·®ï¼ˆNeighbor-encodingï¼‰æ¥é—´æ¥æŠ‘åˆ¶ä½ç»´ç©ºé—´ä¸­é‚»å±…é—´çš„è·ç¦»ã€‚ æ„å»ºæœ‰ç›‘ç£å›¾ åœ¨è¿›å…¥è¿­ä»£ä¼˜åŒ–å‰ï¼Œæ¨¡å‹å…ˆä¸ºæ‰€æœ‰è®­ç»ƒæ ·æœ¬æ„å»ºä¸€ä¸ªå›¾ ï¼Œåˆ©ç”¨äº†ç±»åˆ«ä¿¡æ¯å’Œæ¬§æ°è·ç¦»ï¼š åŒç±»è¿‘é‚»ï¼š å¦‚æœæ ·æœ¬ å’Œ å±äºåŒä¸€ç±»ï¼Œä¸” æ˜¯ çš„ ä¸ªæœ€è¿‘é‚»ä¹‹ä¸€ï¼Œé‚£ä¹ˆå°±åœ¨å®ƒä»¬ä¹‹é—´è¿ä¸€æ¡è¾¹ï¼Œå¹¶èµ‹äºˆä¸€ä¸ªæƒé‡ ã€‚ å¼‚ç±»æˆ–è¿œé‚»ï¼š å¦‚æœç±»åˆ«ä¸åŒæˆ–è€…è·ç¦»å¤ªè¿œï¼Œæƒé‡ ã€‚ é‚»åŸŸç¼–ç  åœ¨æ„å»ºå­ç©ºé—´ï¼ˆå­¦ä¹  å’Œ ï¼‰æ—¶ï¼Œç›®æ ‡å‡½æ•°ä¸å†ä»…ä»…æ˜¯æœ€å°åŒ– ï¼Œè€Œæ˜¯åŠ å…¥äº†åŸºäºå›¾çš„çº¦æŸã€‚å¦‚æœ å¾ˆå¤§ï¼Œæ¨¡å‹ä¼šå¼ºåˆ¶è¦æ±‚ï¼š åœ¨ä½ç»´ç©ºé—´ ä¸­é å¾—æ›´è¿‘ï¼š å’Œ çš„è·ç¦»å¿…é¡»å°½å¯èƒ½å°ã€‚ å…±äº«é‡æ„ç‰¹å¾ï¼š å®ƒä»¬çš„é‡æ„è¿‡ç¨‹åº”è¯¥å…·æœ‰ä¸€è‡´æ€§ã€‚ å¯¹äºæŠ•å½±çŸ©é˜µ è¦æ±‚å±€éƒ¨ç´§è‡´æ€§ï¼ˆLocal Compactnessï¼‰ã€‚ åœ¨å¯»æ‰¾æŠ•å½±æ–¹å‘æ—¶ï¼Œä¼šè¢«è¦æ±‚æœ€å°åŒ–åŒç±»é‚»å±…åœ¨å­ç©ºé—´ä¸­çš„æ–¹å·®ã€‚å¦‚æœ é€‰çš„æ–¹å‘è®©åŸæœ¬åœ¨ä¸€èµ·çš„åŒç±»æ ·æœ¬åˆ†å¼€äº†ï¼Œé‚£ä¹ˆå›¾æ­£åˆ™åŒ–é¡¹å°±ä¼šäº§ç”Ÿå¾ˆé«˜çš„â€œæƒ©ç½šå€¼â€ã€‚å› æ­¤ï¼Œ æå–å‡ºçš„ç‰¹å¾èƒ½å¤Ÿä¿æŒæ•°æ®çš„å±€éƒ¨æµå½¢ç»“æ„ï¼Œå³åœ¨åŸå§‹é«˜ç»´ç©ºé—´é‡Œé‚»è¿‘çš„åŒç±»ç‚¹ï¼Œåœ¨ä½ç»´å­ç©ºé—´ä¾ç„¶æ˜¯é‚»å±…ã€‚ å¯¹äºé‡æ„çŸ©é˜µ è¦æ±‚ç»“æ„ä¸€è‡´æ€§ã€‚ ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ•°å­¦ä¸Šçš„é€†å˜æ¢ï¼Œå®ƒè¢«èµ‹äºˆäº†â€œå¹³æ»‘â€æ•°æ®çš„ä»»åŠ¡ã€‚é€šè¿‡è€ƒè™‘é‚»åŸŸï¼Œ å­¦ä¹ åˆ°çš„æ˜¯è¯¥ç±»åˆ«æ•°æ®åœ¨å­ç©ºé—´ä¸­çš„åˆ†å¸ƒè§„å¾‹ï¼Œè€Œä¸ä»…ä»…æ˜¯å•ä¸ªç‚¹çš„åæ ‡æ˜ å°„ã€‚å› æ­¤ï¼Œå¦‚æœæŸä¸ªæ ·æœ¬ å«æœ‰å™ªå£°ï¼Œä½†å®ƒçš„é‚»å±…ä»¬æ˜¯å¹²å‡€çš„ï¼Œé‚»åŸŸç¼–ç ä¼šåˆ©ç”¨é‚»å±…çš„ç»“æ„ä¿¡æ¯æ¥è¾…åŠ© çš„é‡æ„ï¼Œä»è€Œâ€œçº æ­£â€å™ªå£°æ ·æœ¬åœ¨å­ç©ºé—´ä¸­çš„åç¦»ã€‚ ä¼˜åŒ–è¿‡ç¨‹ ä»¥äºŒåˆ†ç±»ä¸ºä¾‹ï¼Œå®šä¹‰ç›®æ ‡å‡½æ•°ï¼š åˆ†ç±»é¡¹å›¾æ­£åˆ™åŒ–é‡æ„é¡¹æ­£åˆ™åŒ–é¡¹ çº¦æŸæ¡ä»¶ä¸ºï¼šã€‚ å…¶ä¸­ï¼Œ æ˜¯æŠ•å½±çŸ©é˜µï¼Œ æ˜¯é‡æ„å­—å…¸ï¼Œ æ˜¯ä½ç»´ç©ºé—´ä¸­çš„åˆ†ç±»æƒé‡ï¼Œ æ˜¯åˆ»ç”»å±€éƒ¨ç»“æ„çš„å›¾æƒé‡çŸ©é˜µã€‚ ç”¨äºå¹³è¡¡â€œæœ€å¤§åŒ–åˆ†ç±»é—´éš”â€å’Œâ€œæœ€å°åŒ–åˆ†ç±»é”™è¯¯â€ä¹‹é—´çš„æƒé‡ï¼Œ è¶Šå¤§ï¼Œå¯¹åˆ†ç±»é”™è¯¯çš„å®¹å¿åº¦è¶Šä½ã€‚ ç”¨äºæ§åˆ¶â€œç‰¹å¾æå–/ç»“æ„ä¿æŒâ€è¿™ä¸€é¡¹åœ¨æ€»ç›®æ ‡å‡½æ•°ä¸­çš„é‡è¦æ€§ï¼Œ è¶Šå¤§ï¼Œæ¨¡å‹è¶Šå¼ºè°ƒæ•´ä½“æ•°æ®çš„ç»“æ„ä¿æŒå’Œç±»å†…ç´§å‡‘æ€§ã€‚ ç”¨äºæ§åˆ¶æŠ•å½±çŸ©é˜µçš„å¤æ‚åº¦ã€‚ æ˜¯å–æ­£å€¼çš„æ„æ€ï¼Œåœ¨ SVM ä¸­ç”¨æ¥å®šä¹‰ Hinge Lossï¼Œè‹¥åˆ†å¯¹äº†ä¸”ç¦»è¾¹ç•Œå¤Ÿè¿œï¼Œå°±ä¸äº§ç”Ÿ Lossã€‚åˆ†ç±»é”™è¯¯æˆ–åˆ†ç±»æ­£ç¡®ä½†ç¦»è¾¹ç•Œå¤ªè¿‘ï¼ŒæŸå¤±å°±ä¸ºæ­£æ•°ï¼Œç¦»æ­£ç¡®è¾¹ç•Œè¶Šè¿œï¼Œæƒ©ç½šè¶Šå¤§ï¼Œè¿«ä½¿æ¨¡å‹å»ä¿®æ­£å‚æ•°ã€‚ æ˜¯æ ‡å‡†çš„ SVM æŸå¤±å‡½æ•°ï¼Œä½†è¾“å…¥æ•°æ®å˜æˆäº† ï¼Œè¿™æ„å‘³ç€æ¨¡å‹åœ¨å¯»æ‰¾ å’Œ ä½¿å¾—æ•°æ®åœ¨æŠ•å½±åèƒ½è¢«æœ€å¤§é—´éš”åˆ†å¼€ï¼ˆæœ€å¤§åŒ–ç±»é—´é—´éš”ï¼‰ã€‚ è¿™ä¸€é¡¹åˆ©ç”¨é‚»å±… çš„æŠ•å½± ï¼Œé€šè¿‡ æ˜ å°„å›æ¥å»é‡æ„ ï¼ŒåŒç±»æ ·æœ¬åœ¨ä½ç»´ç©ºé—´åº”è¯¥é å¾—å¾ˆè¿‘ï¼Œå¹¶ä¸”èƒ½ä¿ç•™åŸå§‹æ•°æ®çš„ä¿¡æ¯ã€‚è¿™èµ·åˆ°äº†â€œæœ€å°åŒ–ç±»å†…æ•£åº¦â€çš„ä½œç”¨ã€‚ æ˜¯æ­£åˆ™åŒ–é¡¹ï¼Œé˜²æ­¢æŠ•å½±çŸ©é˜µ çš„å€¼è¿‡å¤§ã€‚ ç¬¬ä¸€é˜¶æ®µï¼šå›ºå®šæŠ•å½±çŸ©é˜µå’Œé‡æ„å­—å…¸ï¼Œä¼˜åŒ– SVM å½“ å’Œ å›ºå®šæ—¶ï¼Œç›®æ ‡å‡½æ•°ä¸­ä¸ ç›¸å…³çš„é‡æ„é¡¹å’Œæ­£åˆ™é¡¹éƒ½å˜æˆäº†å¸¸æ•°ã€‚æ­¤æ—¶é—®é¢˜é€€åŒ–ä¸ºï¼š è¿™å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„çº¿æ€§ SVM è®­ç»ƒé—®é¢˜ã€‚ç›®æ ‡æ˜¯åœ¨æŠ•å½±åçš„ä½ç»´å­ç©ºé—´å†…ï¼Œæ‰¾åˆ°ä¸€ä¸ªè¶…å¹³é¢ç³»æ•° ï¼Œä½¿å¾—åˆ†ç±»é—´éš”ï¼ˆMarginï¼‰æœ€å¤§åŒ–ã€‚ ç¬¬äºŒé˜¶æ®µï¼šå›ºå®š SVM å‚æ•°å’Œé‡æ„å­—å…¸ï¼Œä¼˜åŒ–æŠ•å½±çŸ©é˜µ å› ä¸º åŒæ—¶å­˜åœ¨äºåˆ†ç±»é¡¹å’Œé‡æ„é¡¹ä¸­ã€‚ä¸ºäº†æ±‚è§£ï¼Œä½œè€…å¼•å…¥æ¾å¼›å˜é‡ å¹¶åˆ©ç”¨å¯¹å¶ç†è®ºã€‚ é¦–å…ˆè¿›è¡Œç›®æ ‡å‡½æ•°é‡æ„ï¼Œåˆ©ç”¨çŸ©é˜µè¿¹ï¼ˆTraceï¼‰çš„æ€§è´¨ï¼Œé‡æ„é¡¹å¯ä»¥è½¬åŒ–ä¸ºï¼š å…¶ä¸­ å’Œ ï¼Œè¿™ä¸¤ä¸ªçŸ©é˜µè¢«ç§°ä¸ºæ•£å°„çŸ©é˜µï¼ˆScatter Matricesï¼‰ã€‚ é€šå¸¸ä¸æ•°æ®çš„å…¨å±€èƒ½é‡æˆ–æ€»æ–¹å·®æœ‰å…³ï¼Œè€Œ æ•è·äº†åŸºäºå›¾ç»“æ„çš„å±€éƒ¨ç›¸å…³æ€§ã€‚ æ˜¯åº¦çŸ©é˜µï¼ˆDegree Matrixï¼‰ï¼Œæ˜¯ä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼Œå…¶å¯¹è§’çº¿ä¸Šçš„å…ƒç´  æ˜¯ çŸ©é˜µç¬¬ è¡Œï¼ˆæˆ–åˆ—ï¼‰å…ƒç´ çš„æ€»å’Œï¼š åœ¨çŸ©é˜µè¿ç®—ä¸­ï¼Œè¿¹ æ˜¯çŸ©é˜µå¯¹è§’çº¿å…ƒç´ ä¹‹å’Œã€‚ å‘é‡æˆ–çŸ©é˜µçš„äºŒèŒƒæ•°å¹³æ–¹å¯ä»¥å†™æˆè¿¹çš„å½¢å¼ï¼šã€‚å¯¹äºçŸ©é˜µ ï¼šã€‚ çŸ©é˜µçš„è¿¹è¿˜æœ‰å¾ªç¯ç§»ä½çš„æ€§è´¨ï¼šã€‚å¦‚æœä¸€ä¸ªè¿ç®—çš„ç»“æœæ˜¯æ ‡é‡ï¼Œé‚£ä¹ˆå®ƒçš„è¿¹ç­‰äºå®ƒæœ¬èº«ï¼šã€‚ æ¨å¯¼è¿‡ç¨‹ é¦–å…ˆåˆ©ç”¨å‘é‡èŒƒæ•°å…¬å¼ ï¼Œå°†ç›®æ ‡å‡½æ•°å±•å¼€ä¸ºä¸‰é¡¹ï¼š ç¬¬ä¸€é¡¹ç¬¬äºŒé¡¹ç¬¬ä¸‰é¡¹ ç¬¬ä¸€é¡¹æ˜¯å¸¸æ•°é¡¹ï¼Œç”±äº å’Œ åœ¨ä¼˜åŒ–é˜¶æ®µéƒ½æ˜¯å·²çŸ¥çš„ï¼Œè¿™ä¸€é¡¹ä¸åŒ…å«å˜é‡ å’Œ ï¼Œå› æ­¤è®°ä¸º constï¼š åœ¨ç¬¬äºŒé¡¹ä¸­ï¼Œç”±äº æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œå®ƒç­‰äºè‡ªèº«çš„è¿¹ï¼š åˆ©ç”¨è¿¹çš„å¾ªç¯æ€§è´¨ ï¼Œå°† ç§»åˆ°å‰é¢ï¼š ç”±äºè¿¹è¿ç®—å¯¹æ±‚å’Œæ˜¯çº¿æ€§çš„ï¼Œæå– å’Œ ï¼š ç”±äº æ­£å¥½æ˜¯çŸ©é˜µä¹˜æ³• çš„å±•å¼€å½¢å¼ï¼Œå®šä¹‰ ï¼Œåˆ™è¯¥é¡¹ä¸ºï¼š ç¬¬ä¸‰é¡¹é¦–å…ˆåˆ©ç”¨æ­£äº¤çº¦æŸ ç®€åŒ–å†…éƒ¨é¡¹ï¼š çš„ä½œç”¨æ˜¯å°†ä½ç»´ç‰¹å¾ â€œè¿˜åŸâ€å›åŸå§‹ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰ è¿™ä¸ªçº¦æŸï¼Œæ¨¡å‹å¯ä»¥é€šè¿‡æ— é™ç¼©å° å¹¶æ— é™æ”¾å¤§ æ¥ä¿æŒä¹˜ç§¯ä¸å˜ã€‚è¿™ä¼šå¯¼è‡´è®¡ç®—æå…¶ä¸ç¨³å®šã€‚æ­£äº¤åŸºæ„å‘³ç€æ¨¡å‹æ˜¯åœ¨ä¸€ä¸ªæ ‡å‡†ç›´è§’åæ ‡ç³»ä¸‹è¿›è¡Œé‡æ„ï¼Œè¿™ä¿è¯äº†é‡æ„è¿‡ç¨‹åªæ˜¯åœ¨å¯»æ‰¾åŸå§‹æ•°æ®åœ¨å­ç©ºé—´ä¸Šçš„æŠ•å½±ç‚¹ï¼Œè€Œä¸ä¼šå¯¹æ•°æ®äº§ç”Ÿéçº¿æ€§çš„æ‹‰ä¼¸æˆ–å‰ªåˆ‡ã€‚ å¯¹äºæŠ•å½±çŸ©é˜µè€Œè¨€ï¼Œ çš„è§’è‰²æ˜¯å¯»æ‰¾æœ€æœ‰åˆ©äºåˆ†ç±»çš„ç‰¹å¾ï¼Œè™½ç„¶ æ²¡æœ‰æ­£äº¤çº¦æŸï¼Œä½†å®ƒæœ‰ æ­£åˆ™åŒ–é¡¹ã€‚è¿™é‡Œçš„æ­£åˆ™åŒ–æ˜¯ Frobenius èŒƒæ•°ï¼ŒæŠŠçŸ©é˜µé‡Œæ‰€æœ‰çš„å…ƒç´ å…ˆå¹³æ–¹ã€å†æ±‚å’Œã€æœ€åå¼€æ ¹å·ã€‚Frobenius èŒƒæ•°é™åˆ¶äº†æŠ•å½±çŸ©é˜µ ä¸­å…ƒç´ çš„å¤§å°ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸€é¡¹ï¼Œ çš„æ•°å€¼å¯èƒ½ä¼šä¸ºäº†è¿åˆæŸäº›å™ªå£°æ•°æ®è€Œå˜å¾—æå¤§ï¼Œå¯¼è‡´æ¨¡å‹æ³›åŒ–èƒ½åŠ›å˜å·®ï¼š å›åˆ°å…¬å¼çš„æ¨å¯¼ï¼Œä»£å›åŸå¼å¹¶è€ƒè™‘å¯¹ çš„æ±‚å’Œï¼š åˆ©ç”¨åº¦çŸ©é˜µå®šä¹‰ ï¼š è½¬åŒ–ä¸ºè¿¹çš„å½¢å¼å¹¶åˆ©ç”¨å¾ªç¯æ€§è´¨ï¼š ç”±äº æ­£å¥½æ˜¯çŸ©é˜µä¹˜æ³• çš„å¯¹è§’åŠ æƒå½¢å¼ï¼Œå®šä¹‰ ï¼Œåˆ™è¯¥é¡¹ä¸ºï¼š å°†ä¸‰é¡¹åˆå¹¶ï¼Œå¾—åˆ°äº†è®ºæ–‡ä¸­çš„ç®€æ´å½¢å¼ï¼š åœ¨å›ºå®š å’Œ åï¼ŒODSVM çš„ç›®æ ‡å‡½æ•° ä¸å˜é‡ å’Œæ¾å¼›å˜é‡ ç›¸å…³çš„éƒ¨åˆ†å¯ä»¥å†™æˆï¼š é‡æ„é¡¹çš„æ­£åˆ™é¡¹è¯¯å·®é¡¹ çº¦æŸæ¡ä»¶æ¥è‡ªäº SVM çš„åŸºæœ¬è¦æ±‚ï¼Œå³æ ·æœ¬å¿…é¡»è½åœ¨é—´éš”ä¹‹å¤–æˆ–é€šè¿‡æ¾å¼›å˜é‡è¡¥å¿ï¼šï¼Œæ¾å¼›å˜é‡éè´Ÿï¼šã€‚ æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•è¦æ±‚çº¦æŸæ¡ä»¶å†™æˆ çš„å½¢å¼ï¼šï¼Œã€‚ æ‹‰æ ¼æœ—æ—¥å‡½æ•°çš„åŸºæœ¬æ„é€ å…¬å¼ä¸ºï¼šç›®æ ‡å‡½æ•°ä¹˜å­çº¦æŸã€‚ å¼•å…¥ä¸¤ç»„æ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼š å¯¹åº”åˆ†ç±»çº¦æŸï¼Œ å¯¹åº”éè´Ÿçº¦æŸï¼š è¿›ä¸€æ­¥æŠŠä¸Šå¼è¿›è¡ŒåŒ–ç®€ï¼š æ˜¯å¯¹åˆ†ç±»é”™è¯¯çš„æƒ©ç½šæ€»å’Œï¼Œå…¶ä¸­ ï¼Œæ‰€ä»¥ ã€‚è¿™é‡Œçœç•¥äº† é¡¹ï¼Œæ˜¯å› ä¸ºåç»­çš„æ±‚åå¯¼è¿‡ç¨‹æœ‰ï¼š ç”±äº ï¼Œè¿™ä¸ªæ¡ä»¶éšå«äº† ã€‚å› æ­¤ï¼Œé’ˆå¯¹ ä¼˜åŒ–æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ—¶é€šå¸¸å¯ä»¥çœç•¥ é¡¹ï¼Œé€šè¿‡åœ¨åç»­æ±‚è§£ çš„å¯¹å¶é—®é¢˜æ—¶ï¼Œç»™ åŠ ä¸Šä¸Šé™ ï¼ˆå³ ï¼‰æ¥ç­‰ä»·åœ°å¤„ç† çš„çº¦æŸã€‚ æ¥ç€æ±‚å¯¼å¾—å‡º çš„æ˜¾å¼è¡¨è¾¾ï¼Œä»¤ ï¼Œå¯ä»¥è§£å‡º å…³äº çš„å‡½æ•°ã€‚ é¦–å…ˆï¼Œä»å®Œæ•´çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸­ï¼Œå‰”é™¤æ‰æ‰€æœ‰ä¸åŒ…å« çš„é¡¹ï¼Œå› ä¸ºæ±‚å¯¼åä¼šå˜æˆ0ï¼Œå¾—åˆ°å…³äº çš„å­å‡½æ•° ï¼š é¡¹é¡¹é¡¹é¡¹ åœ¨æ¨å¯¼è¿‡ç¨‹éœ€è¦ç”¨åˆ°ä»¥ä¸‹ä¸‰ä¸ªçŸ©é˜µæ±‚å¯¼å…¬å¼ï¼š å…¬å¼ Aï¼š ã€‚ç”±äº æ˜¯å¯¹ç§°çŸ©é˜µï¼Œç»“æœä¸º ã€‚ å…¬å¼ Bï¼š ã€‚ å…¬å¼ Cï¼š ã€‚ å°† åˆ†æˆå››éƒ¨åˆ†è¿›è¡Œè®¡ç®—ï¼š æ±‚å¯¼é¡¹ 1ï¼š æ ¹æ®å…¬å¼ Aï¼Œç”±äº æ˜¯å¯¹ç§°çš„ï¼š é¡¹ æ±‚å¯¼é¡¹ 2ï¼š æ ¹æ®å…¬å¼ Bï¼Œå…¶ä¸­ ï¼š é¡¹ æ±‚å¯¼é¡¹ 3ï¼š è¿™ç­‰ä»·äºå…¬å¼ A ä¸­ çš„æƒ…å†µï¼š é¡¹ æ±‚å¯¼é¡¹ 4ï¼š è¿™ä¸€æ­¥éœ€è¦å…ˆè¿›è¡ŒçŸ©é˜µåŒ–å¤„ç†ã€‚ è§‚å¯Ÿå•ä¸ªé¡¹ï¼šã€‚è¿™é‡Œ æ˜¯åˆ†ç±»æƒé‡ï¼Œ æ˜¯æ ·æœ¬ã€‚ åˆ©ç”¨å…¬å¼ Cï¼Œå…¶ä¸­ ï¼Œ ã€‚å…¶å¯¼æ•°ä¸º ã€‚ å¯¹æ‰€æœ‰ æ±‚å’Œï¼š é¡¹ å¼•å…¥çŸ©é˜µ å’Œå‘é‡ ï¼Œä¸Šé¢çš„æ±‚å’Œé¡¹ æ­£å¥½ç­‰äºçŸ©é˜µä¹˜ç§¯ ã€‚æ‰€ä»¥æœ‰ï¼š é¡¹ å°†ä¸Šè¿°æ‰€æœ‰ç»“æœåˆå¹¶ï¼Œå¾—åˆ°æ€»æ¢¯åº¦ï¼š åŒ–ç®€åå¾—åˆ°ï¼š è¿™é‡ŒåŒ…å«ä¸‰éƒ¨åˆ†ï¼š è¦æ±‚æŠ•å½±çŸ©é˜µé…åˆé‡æ„å­—å…¸ å’Œå›¾ç»“æ„ ï¼Œå°½é‡ä¿ç•™æ•°æ®çš„åŸå§‹å‡ ä½•ä¿¡æ¯ è¦æ±‚æŠ•å½±çŸ©é˜µå‚è€ƒ SVM çš„åˆ†ç±»ç»“æœï¼ŒæŠŠä¸åŒç±»åˆ«çš„æ ·æœ¬æ‹‰å¼€ï¼Œå…¶é€šè¿‡æ‹‰æ ¼æœ—æ—¥ä¹˜å­ å’Œæƒé‡ ä¼ é€’ åˆ™èµ·åˆ°äº†ä¸€ä¸ªâ€œå½’ä¸€åŒ–â€å’Œâ€œç¨³å®šå™¨â€çš„ä½œç”¨ï¼Œç¡®ä¿ ä¸ä¼šå› ä¸ºå•æ–¹é¢çš„åŠ›é‡è€Œæ•°å€¼çˆ†ç‚¸ å½“å¾—åˆ°äº†ä¸Šè¿°æŠ•å½±çŸ©é˜µçš„æ˜¾ç¤ºè¡¨è¾¾åï¼Œæ¥ä¸‹æ¥è¦æ±‚è§£é’ˆå¯¹ çš„äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼ˆQPPï¼‰ï¼Œéœ€è¦å°†ç¬¬äºŒé˜¶æ®µæ±‚å¾—çš„ çš„æ˜¾å¼è¡¨è¾¾ä»£å›æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºå¯¹å¶åŒ–ï¼ˆDualizationï¼‰ã€‚ é¦–å…ˆå¯¹æ‹‰æ ¼æœ—æ—¥å‡½æ•°è¿›è¡Œç®€åŒ–ï¼š ä¸Šå¼åˆå¹¶äº†é‡æ„é¡¹å’Œ çš„æ­£åˆ™é¡¹ï¼Œä½¿ç”¨ ï¼Œä»¥åŠå°†åˆ†ç±»çº¦æŸé¡¹ å†™æˆäº†çŸ©é˜µå½¢å¼ï¼šã€‚ åˆ©ç”¨ Karush-Kuhn-Tuckerï¼ˆKKTï¼‰ æ¡ä»¶ç®€åŒ– å’Œçº¦æŸï¼Œå…ˆé’ˆå¯¹æ¾å¼›å˜é‡ æ±‚åå¯¼ï¼š å› ä¸ºä¹˜å­ ï¼Œè¿™ç›´æ¥ç»™å‡ºäº† çš„èŒƒå›´çº¦æŸï¼š åŒæ—¶ï¼Œç”±äº ï¼Œæ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸­çš„ é¡¹å˜ä¸º 0ã€‚ æŠŠåœ¨ä¸Šä¸€é˜¶æ®µæ±‚å¾— çš„æœ€ä¼˜è§£åŒ–ç®€ä¸ºï¼š å…¶ä¸­ ã€‚ å°† ä»£å…¥æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸­å…³äº çš„éƒ¨åˆ†ï¼š ç”±äº æ˜¯å¯¹ç§°çŸ©é˜µï¼Œå› æ­¤ ä¹Ÿæ˜¯å¯¹ç§°çŸ©é˜µï¼Œæœ‰ ï¼Œç®€åŒ–å¾—ï¼š å°† ä»£å…¥ï¼š å±•å¼€åå¾—åˆ°å››é¡¹ï¼š ç¬¬ä¸€é¡¹ï¼š ã€‚è¿™ä¸åŒ…å« ï¼Œåœ¨ä¼˜åŒ–æ—¶æ˜¯å¸¸æ•°ã€‚ ç¬¬äºŒé¡¹ï¼š ã€‚ ç¬¬ä¸‰é¡¹ï¼š ã€‚ ç¬¬å››é¡¹ï¼š ã€‚ æ¥ä¸‹æ¥å¯¹ä¸Šè¿°å››é¡¹åˆ†åˆ«æ±‚è¿¹ï¼Œå› ä¸ºç¬¬äºŒé¡¹å’Œç¬¬ä¸‰é¡¹äº’ä¸ºè½¬ç½®ï¼Œå› æ­¤ï¼š å¯¹äºç¬¬å››é¡¹åˆ©ç”¨ ï¼Œå¾—åˆ°ï¼š å›åˆ°ä¸€å¼€å§‹çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š åˆšåˆšçš„åŒ–ç®€å’Œæ±‚è¿¹éƒ½æ˜¯é’ˆå¯¹ è¿›è¡Œçš„ï¼Œ è¢«æ”¾åœ¨äº†ä¸€è¾¹ï¼Œç°åœ¨è®¡ç®—å®Œæˆåéœ€è¦å°†ç»“æœå’Œ åˆå¹¶ï¼š æœ€å¤§åŒ–è¿™ä¸ªå¯¹å¶å‡½æ•° ï¼Œå³å¾—åˆ°äº†è®ºæ–‡ä¸­çš„ QPP é—®é¢˜ï¼š è¿™é‡Œçš„äºŒæ¬¡é¡¹ åæ˜ äº†æ ·æœ¬åœ¨ç»è¿‡ ç¼©æ”¾å¤„ç†åçš„ç›¸å…³æ€§ï¼Œ çš„å­˜åœ¨è¯´æ˜åˆ†ç±»å™¨çš„æƒé‡ç›´æ¥å½±å“äº†å­ç©ºé—´çš„æ‹‰ä¼¸ã€‚ä¸€æ¬¡é¡¹ è¡¨ç¤ºæ ‡å‡† SVM è¦æ±‚æ ·æœ¬ç¦»å¼€è¶…å¹³é¢ï¼Œè€Œå‡å»çš„ éƒ¨åˆ†åˆ™æ˜¯æ¥è‡ªé‡æ„è¯¯å·®çš„ä¿®æ­£ã€‚å®ƒå‘Šè¯‰æ¨¡å‹ï¼Œå¦‚æœæŸä¸ªæ ·æœ¬ä¸ºäº†é‡æ„è€Œå¿…é¡»å¾…åœ¨æŸä¸ªä½ç½®ï¼Œé‚£ä¹ˆ SVM å¯¹å®ƒçš„åˆ†ç±»çº¦æŸå¯ä»¥ç¨å¾®â€œå¦¥åâ€ä¸€ç‚¹ã€‚ ç¬¬ä¸‰é˜¶æ®µï¼šå›ºå®šæŠ•å½±çŸ©é˜µå’Œ SVMï¼Œä¼˜åŒ–é‡æ„å­—å…¸ å½“ å’Œ å›ºå®šæ—¶ï¼Œç›®æ ‡å‡½æ•°åªå‰©ä¸‹ä¸é‡æ„ç›¸å…³çš„éƒ¨åˆ†ã€‚ è¿™é‡ŒæŠŠæœ€å¼€å§‹ç›®æ ‡å‡½æ•°çš„ç®€æ´å½¢å¼æ¬è¿‡æ¥ï¼š åœ¨è¿™ä¸€é˜¶æ®µè¦ä¼˜åŒ–çš„é‡æ„å½¢å¼ä¸ºï¼š è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„æ­£äº¤æ™®é²å…‹åˆ†æï¼ˆOrthogonal Procrustes Problemï¼‰ï¼Œå®ƒæœ‰é—­å¼è§£ï¼ˆClosed-form solutionï¼‰ï¼š é¦–å…ˆè®¡ç®—çŸ©é˜µä¹˜ç§¯ ï¼Œå¯¹è¯¥ç»“æœè¿›è¡Œå¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰ï¼šï¼Œå¾—åˆ°çš„æœ€ä¼˜çš„é‡æ„çŸ©é˜µä¸ºï¼šã€‚","categories":[{"name":"æ–‡çŒ®é˜…è¯»","slug":"æ–‡çŒ®é˜…è¯»","permalink":"http://example.com/categories/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/"}],"tags":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://example.com/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"é›†æˆå­¦ä¹ ","slug":"é›†æˆå­¦ä¹ ","permalink":"http://example.com/tags/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/"},{"name":"å­ç©ºé—´å­¦ä¹ ","slug":"å­ç©ºé—´å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0/"}]}],"categories":[{"name":"ç®—æ³•å­¦ä¹ ","slug":"ç®—æ³•å­¦ä¹ ","permalink":"http://example.com/categories/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/"},{"name":"æ–‡çŒ®é˜…è¯»","slug":"æ–‡çŒ®é˜…è¯»","permalink":"http://example.com/categories/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/"}],"tags":[{"name":"æ¨èç³»ç»Ÿ","slug":"æ¨èç³»ç»Ÿ","permalink":"http://example.com/tags/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://example.com/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"é›†æˆå­¦ä¹ ","slug":"é›†æˆå­¦ä¹ ","permalink":"http://example.com/tags/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/"},{"name":"å­ç©ºé—´å­¦ä¹ ","slug":"å­ç©ºé—´å­¦ä¹ ","permalink":"http://example.com/tags/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0/"}]}